{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { Ionicons, Feather } from \"@expo/vector-icons\";\nimport Input from \"../components/InputCreatePost\";\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useIsFocused } from \"@react-navigation/native\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport { selectStateUserId, selectStateAvatar, selectStateLogin } from \"../redux/selectors\";\nimport { db, storage } from \"../firebase/config\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { doc, setDoc, Timestamp } from \"firebase/firestore\";\nimport { Camera } from \"expo-camera\";\nimport CustomButton, { UnactiveButton } from \"../components/Button\";\nimport { ActionSheetIOS } from \"react-native-web/dist/index\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport * as Location from \"expo-location\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { LoaderScreen } from \"../Screens/LoaderScreen\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar INITIAL_POST = {\n  photoUri: \"\",\n  titlePost: \"\",\n  location: {\n    latitude: \"\",\n    longitude: \"\",\n    postAddress: \"\"\n  }\n};\nexport default function CreatePostsScreen() {\n  var _state$location;\n  var navigation = useNavigation();\n  var isFocused = useIsFocused();\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isShowLoader = _useState2[0],\n    setIsShowLoader = _useState2[1];\n  var _useState3 = useState(INITIAL_POST),\n    _useState4 = _slicedToArray(_useState3, 2),\n    state = _useState4[0],\n    setState = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isDirtyForm = _useState6[0],\n    setIsDirtyForm = _useState6[1];\n  var _useState7 = useState(0),\n    _useState8 = _slicedToArray(_useState7, 2),\n    keyboardHeight = _useState8[0],\n    setKeyboardHeight = _useState8[1];\n  var _Camera$useCameraPerm = Camera.useCameraPermissions(),\n    _Camera$useCameraPerm2 = _slicedToArray(_Camera$useCameraPerm, 2),\n    permissionCam = _Camera$useCameraPerm2[0],\n    requestPermissionCam = _Camera$useCameraPerm2[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    cameraRef = _useState10[0],\n    setCameraRef = _useState10[1];\n  var _useState11 = useState(0),\n    _useState12 = _slicedToArray(_useState11, 2),\n    buttonPressCount = _useState12[0],\n    setButtonPressCount = _useState12[1];\n  var _useState13 = useState(Camera.Constants.Type.back),\n    _useState14 = _slicedToArray(_useState13, 2),\n    type = _useState14[0],\n    setType = _useState14[1];\n  var userId = useSelector(selectStateUserId);\n  var avatar = useSelector(selectStateAvatar);\n  var login = useSelector(selectStateLogin);\n  useEffect(function () {\n    var unsubscribe = navigation.addListener(\"blur\", function () {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n    });\n    return unsubscribe;\n  }, []);\n  useEffect(function () {\n    navigation.setParams({\n      isDirtyForm: isDirtyForm\n    });\n  }, [isDirtyForm]);\n  useEffect(function () {\n    var keyboardDidShowListener = Keyboard.addListener(\"keyboardDidShow\", function (event) {\n      var height = event.endCoordinates.height;\n      setKeyboardHeight(height - 300);\n    });\n    var keyboardDidHideListener = Keyboard.addListener(\"keyboardDidHide\", function () {\n      setKeyboardHeight(0);\n    });\n    return function () {\n      keyboardDidShowListener.remove();\n      keyboardDidHideListener.remove();\n    };\n  }, []);\n  var handleCameraPress = function () {\n    var _ref = _asyncToGenerator(function* () {\n      ActionSheetIOS.showActionSheetWithOptions({\n        options: [\"Сделать фото\", \"Выбрать из галереи\", \"Отмена\"],\n        cancelButtonIndex: 2\n      }, function () {\n        var _ref2 = _asyncToGenerator(function* (buttonIndex) {\n          if (buttonIndex === 0) {\n            var _yield$Camera$request = yield Camera.requestCameraPermissionsAsync(),\n              status = _yield$Camera$request.status;\n            if (status === \"granted\") {\n              if (buttonPressCount === 0) {\n                takePhoto();\n              } else if (buttonPressCount === 1) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    photoUri: \"\"\n                  });\n                });\n                takePhoto();\n              }\n            } else {\n              console.log(\"Разрешение на использование камеры не было предоставлено\");\n            }\n          } else if (buttonIndex === 1) {\n            var _yield$ImagePicker$re = yield ImagePicker.requestMediaLibraryPermissionsAsync(),\n              _status = _yield$ImagePicker$re.status;\n            if (_status === \"granted\") {\n              var result = yield ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.Images,\n                allowsEditing: true,\n                aspect: [1, 1],\n                quality: 1\n              });\n              if (!result.canceled) {\n                var selectedAsset = yield MediaLibrary.createAssetAsync(result.assets[0].uri);\n                var selectedUri = yield MediaLibrary.getAssetInfoAsync(selectedAsset);\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    photoUri: selectedUri.uri\n                  });\n                });\n              }\n            }\n          }\n          setButtonPressCount(1);\n        });\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    });\n    return function handleCameraPress() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  if (!permissionCam.granted) {\n    return _jsxs(View, {\n      style: styles.permission,\n      children: [_jsx(Text, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: \"We need your permission to show the camera\"\n      }), _jsx(CustomButton, {\n        onPress: requestPermissionCam,\n        title: \"grant permission\"\n      })]\n    });\n  }\n  var takePhoto = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      if (cameraRef) {\n        try {\n          var _yield$cameraRef$curr = yield cameraRef.current.takePictureAsync(),\n            uri = _yield$cameraRef$curr.uri;\n          var newUri = yield ImageManipulator(uri, [{\n            resize: {\n              height: 480,\n              width: 680\n            }\n          }], 0.5);\n          setState(function (prev) {\n            return _objectSpread(_objectSpread({}, prev), {}, {\n              photoUri: newUri\n            });\n          });\n          setIsDirtyForm(true);\n        } catch (error) {\n          console.log(\"takePhoto ===>>> \", error.message);\n        }\n      }\n    });\n    return function takePhoto() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var pickImage = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        var _yield$ImagePicker$la = yield ImagePicker.launchImageLibraryAsync({\n            mediaTypes: ImagePicker.MediaTypeOptions.All,\n            allowsEditing: true,\n            aspect: [4, 3],\n            quality: 1\n          }),\n          assets = _yield$ImagePicker$la.assets,\n          canceled = _yield$ImagePicker$la.canceled;\n        if (!canceled) {\n          var _assets = _slicedToArray(assets, 1),\n            uri = _assets[0].uri;\n          var newUri = yield ImageManipulator(uri, [{\n            resize: {\n              height: 480,\n              width: 680\n            }\n          }], 0.5);\n          setState(function (prev) {\n            return _objectSpread(_objectSpread({}, prev), {}, {\n              photoUri: newUri\n            });\n          });\n          setIsDirtyForm(true);\n        }\n      } catch (error) {\n        console.log(\"pickImage ====>> \", error.message);\n      }\n    });\n    return function pickImage() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var draggableMarker = function () {\n    var _ref6 = _asyncToGenerator(function* (_ref5) {\n      var latitude = _ref5.latitude,\n        longitude = _ref5.longitude;\n      var time = Date.now().toString();\n      try {\n        var _yield$Location$rever = yield Location.reverseGeocodeAsync({\n            latitude: latitude,\n            longitude: longitude\n          }),\n          _yield$Location$rever2 = _slicedToArray(_yield$Location$rever, 1),\n          postAddress = _yield$Location$rever2[0];\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            location: {\n              latitude: latitude,\n              longitude: longitude,\n              postAddress: postAddress,\n              time: time\n            }\n          });\n        });\n      } catch (error) {\n        console.log(\"draggableMarker ====>> \", error.message);\n      }\n    });\n    return function draggableMarker(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var uploadPhotoToServer = function () {\n    var _ref7 = _asyncToGenerator(function* () {\n      var uniquePostId = Date.now().toString();\n      try {\n        var response = yield fetch(state.photoUri);\n        var file = yield response.blob();\n        var imageRef = ref(storage, \"postImages/\" + uniquePostId);\n        var q = yield uploadBytes(imageRef, file);\n        var link = yield getDownloadURL(imageRef);\n        return link;\n      } catch (error) {\n        console.log(\"uploadPhotoToServer =====>> \", error);\n        alert(\"Вибачте, але фото не зберіглось на сервері\", error.message);\n      }\n    });\n    return function uploadPhotoToServer() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n  var uploadPostToServer = function () {\n    var _ref8 = _asyncToGenerator(function* () {\n      setIsShowLoader(true);\n      var uniquePostId = Date.now().toString();\n      try {\n        var photo = yield uploadPhotoToServer();\n        var postRef = doc(db, \"posts\", uniquePostId);\n        yield setDoc(postRef, {\n          photo: photo,\n          titlePost: state.titlePost ? state.titlePost : \"Незабутня подія\",\n          location: state.location,\n          createdAt: Timestamp.fromDate(new Date()),\n          updatedAt: Timestamp.fromDate(new Date()),\n          owner: {\n            userId: userId,\n            login: login,\n            avatar: avatar\n          }\n        });\n      } catch (error) {\n        console.log(\"uploadPostToServer ===>>\", error);\n        alert(\"Вибачте, але публікація не зберіглась на сервері\", error.message);\n      } finally {\n        setState(INITIAL_POST);\n        setIsDirtyForm(false);\n        setIsShowLoader(false);\n        navigation.navigate(\"PostsScreen\", {\n          screen: \"Posts\"\n        });\n      }\n    });\n    return function uploadPostToServer() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  return _jsx(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    children: _jsx(View, {\n      style: styles.main,\n      children: _jsxs(View, {\n        style: styles.parent,\n        children: [_jsx(View, {\n          children: buttonPressCount == 0 ? _jsx(View, {\n            style: styles.camera,\n            ref: setCameraRef,\n            children: _jsx(View, {\n              style: styles.photoViewSelected,\n              children: _jsx(TouchableOpacity, {\n                style: [styles.cameraButtonSelected, {\n                  backgroundColor: \"lightgrey\"\n                }],\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#fff\"\n                })\n              })\n            })\n          }) : state.photoUri ? _jsx(ImageBackground, {\n            source: {\n              uri: state.photoUri\n            },\n            style: styles.camera,\n            ref: setCameraRef,\n            children: _jsx(View, {\n              style: styles.photoViewSelected,\n              children: _jsx(TouchableOpacity, {\n                style: styles.cameraButtonSelected,\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#fff\"\n                })\n              })\n            })\n          }) : _jsx(Camera, {\n            style: styles.camera,\n            type: type,\n            ref: setCameraRef,\n            children: _jsxs(View, {\n              style: styles.photoView,\n              children: [_jsx(TouchableOpacity, {\n                style: styles.flipContainer,\n                onPress: function onPress() {\n                  setType(type === Camera.Constants.Type.back ? Camera.Constants.Type.front : Camera.Constants.Type.back);\n                },\n                children: _jsx(Feather, {\n                  name: \"repeat\",\n                  size: 20,\n                  color: \"#BDBDBD\"\n                })\n              }), _jsx(TouchableOpacity, {\n                style: styles.cameraButton,\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#BDBDBD\"\n                })\n              })]\n            })\n          })\n        }), state.photoUri !== \"\" ? _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return setState(function (prev) {\n              return _objectSpread(_objectSpread({}, prev), {}, {\n                photoUri: \"\"\n              });\n            });\n          },\n          children: _jsx(Text, {\n            style: styles.text,\n            children: \"\\u0420\\u0435\\u0434\\u0430\\u0433\\u0443\\u0432\\u0430\\u0442\\u0438 \\u0444\\u043E\\u0442\\u043E\"\n          })\n        }) : _jsx(TouchableOpacity, {\n          onPress: pickImage,\n          children: _jsx(Text, {\n            style: styles.text,\n            children: \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438 \\u0444\\u043E\\u0442\\u043E\"\n          })\n        }), _jsx(View, {\n          style: {\n            marginTop: -keyboardHeight\n          },\n          children: _jsxs(KeyboardAvoidingView, {\n            behavior: Platform.OS == \"ios\" ? \"padding\" : \"height\",\n            children: [_jsx(Input, {\n              placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430...\",\n              value: state.titlePost,\n              onChangeText: function onChangeText(value) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    titlePost: value\n                  });\n                });\n                setIsDirtyForm(value.length > 0 ? true : false);\n              }\n            }), _jsx(Ionicons, {\n              style: {\n                position: \"absolute\",\n                top: 10,\n                left: 10\n              },\n              name: \"attach\",\n              size: 25,\n              color: \"#BDBDBD\"\n            }), _jsx(Input, {\n              placeholder: \"\\u041C\\u0456\\u0441\\u0446\\u0435\\u0432\\u0456\\u0441\\u0442\\u044C...\",\n              value: (_state$location = state.location) == null ? void 0 : _state$location.title,\n              onChangeText: function onChangeText(value) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    location: _objectSpread(_objectSpread({}, prev.location), {}, {\n                      title: value\n                    })\n                  });\n                });\n                setIsDirtyForm(value.length > 0 ? true : false);\n              }\n            }), _jsx(Ionicons, {\n              style: {\n                position: \"absolute\",\n                top: 80,\n                left: 10\n              },\n              name: \"navigate\",\n              size: 20,\n              color: \"#BDBDBD\"\n            })]\n          })\n        }), state.photoUri !== \"\" && state.location !== \"\" && state.titlePost !== \"\" ? _jsx(CustomButton, {\n          text: \"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0456\\u043A\\u0443\\u0432\\u0430\\u0442\\u0438\",\n          onPress: uploadPostToServer\n        }) : _jsx(UnactiveButton, {\n          text: \"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0456\\u043A\\u0443\\u0432\\u0430\\u0442\\u0438\"\n        }), _jsxs(View, {\n          style: styles.delete,\n          children: [_jsx(UnactiveButton, {\n            width: 70,\n            onPress: function onPress() {\n              return setState(INITIAL_POST);\n            }\n          }), _jsx(Ionicons, {\n            style: {\n              position: \"absolute\",\n              top: 25,\n              left: 22\n            },\n            name: \"trash\",\n            size: 25,\n            color: \"#BDBDBD\"\n          })]\n        })]\n      })\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  main: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    borderColor: \"grey\",\n    borderTopWidth: 1,\n    borderBottomWidth: 1\n  },\n  parent: {\n    marginHorizontal: 20,\n    marginVertical: 40\n  },\n  container: {\n    flex: 1,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  camera: {\n    width: \"100%\",\n    height: 240,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#f6f6f6\",\n    borderColor: \"#E8E8E8\",\n    borderWidth: 1,\n    borderRadius: 8,\n    overflow: \"hidden\"\n  },\n  cameraButton: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"#fff\",\n    borderRadius: \"50%\"\n  },\n  photoView: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    justifyContent: \"center\"\n  },\n  cameraButtonSelected: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"rgba(255, 255, 255, 0.3);\",\n    borderRadius: \"50%\"\n  },\n  photoViewSelected: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    marginTop: 90\n  },\n  flipContainer: {\n    position: \"absolute\",\n    top: 10,\n    right: -120\n  },\n  text: {\n    color: \"#BDBDBD\",\n    marginLeft: 10,\n    marginTop: 10,\n    marginBottom: 20\n  },\n  placeholderContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  placeholderText: {\n    marginLeft: 5,\n    color: \"#BDBDBD\"\n  },\n  delete: {\n    position: \"absolute\",\n    top: \"130%\",\n    right: \"28%\",\n    transform: [{\n      translateX: -50\n    }, {\n      translateY: -50\n    }],\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"names":["Ionicons","Feather","Input","React","useState","useEffect","useSelector","useIsFocused","Text","View","TouchableOpacity","StyleSheet","TouchableWithoutFeedback","Keyboard","KeyboardAvoidingView","Platform","ImageBackground","selectStateUserId","selectStateAvatar","selectStateLogin","db","storage","ref","uploadBytes","getDownloadURL","doc","setDoc","Timestamp","Camera","CustomButton","UnactiveButton","ActionSheetIOS","ImagePicker","MediaLibrary","Location","useNavigation","LoaderScreen","jsx","_jsx","jsxs","_jsxs","INITIAL_POST","photoUri","titlePost","location","latitude","longitude","postAddress","CreatePostsScreen","_state$location","navigation","isFocused","_useState","_useState2","_slicedToArray","isShowLoader","setIsShowLoader","_useState3","_useState4","state","setState","_useState5","_useState6","isDirtyForm","setIsDirtyForm","_useState7","_useState8","keyboardHeight","setKeyboardHeight","_Camera$useCameraPerm","useCameraPermissions","_Camera$useCameraPerm2","permissionCam","requestPermissionCam","_useState9","_useState10","cameraRef","setCameraRef","_useState11","_useState12","buttonPressCount","setButtonPressCount","_useState13","Constants","Type","back","_useState14","type","setType","userId","avatar","login","unsubscribe","addListener","setParams","keyboardDidShowListener","event","height","endCoordinates","keyboardDidHideListener","remove","handleCameraPress","_ref","_asyncToGenerator","showActionSheetWithOptions","options","cancelButtonIndex","_ref2","buttonIndex","_yield$Camera$request","requestCameraPermissionsAsync","status","takePhoto","prev","_objectSpread","console","log","_yield$ImagePicker$re","requestMediaLibraryPermissionsAsync","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","canceled","selectedAsset","createAssetAsync","assets","uri","selectedUri","getAssetInfoAsync","_x","apply","arguments","granted","style","styles","permission","children","textAlign","onPress","title","_ref3","_yield$cameraRef$curr","current","takePictureAsync","newUri","ImageManipulator","resize","width","error","message","pickImage","_ref4","_yield$ImagePicker$la","All","_assets","draggableMarker","_ref6","_ref5","time","Date","now","toString","_yield$Location$rever","reverseGeocodeAsync","_yield$Location$rever2","_x2","uploadPhotoToServer","_ref7","uniquePostId","response","fetch","file","blob","imageRef","q","link","alert","uploadPostToServer","_ref8","photo","postRef","createdAt","fromDate","updatedAt","owner","navigate","screen","dismiss","main","parent","camera","photoViewSelected","cameraButtonSelected","backgroundColor","name","size","color","source","photoView","flipContainer","front","cameraButton","text","marginTop","behavior","OS","placeholder","value","onChangeText","length","position","top","left","delete","create","flex","borderColor","borderTopWidth","borderBottomWidth","marginHorizontal","marginVertical","container","display","justifyContent","alignItems","borderWidth","borderRadius","overflow","right","marginLeft","marginBottom","placeholderContainer","flexDirection","placeholderText","transform","translateX","translateY"],"sources":["/Users/Anastasia/Desktop/goit-react_native-hw-06-redux-firebase/src/Screens/CreatePostsScreen.js"],"sourcesContent":["import { Ionicons, Feather } from \"@expo/vector-icons\";\nimport Input from \"../components/InputCreatePost\";\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useIsFocused } from \"@react-navigation/native\";\nimport {\n  Text,\n  View,\n  TouchableOpacity,\n  StyleSheet,\n  TouchableWithoutFeedback,\n  Keyboard,\n  KeyboardAvoidingView,\n  Platform,\n  ImageBackground,\n} from \"react-native\";\nimport {\n  selectStateUserId,\n  selectStateAvatar,\n  selectStateLogin,\n} from \"../redux/selectors\";\nimport { db, storage } from \"../firebase/config\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { doc, setDoc, Timestamp } from \"firebase/firestore\";\n\nimport { Camera } from \"expo-camera\";\nimport CustomButton, { UnactiveButton } from \"../components/Button\";\nimport { ActionSheetIOS } from \"react-native\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport * as Location from \"expo-location\";\nimport { useNavigation } from \"@react-navigation/native\";\n// import { saveLocationAction } from \"../redux/post/postActions\";\n// import { writeDataToFirestore } from \"../../firebase/collections\";\n// import {\n//   savePostLocation,\n//   savePostName,\n//   savePostPhoto,\n// } from \"../redux/post/postActions\";\nimport { LoaderScreen } from \"../Screens/LoaderScreen\";\n\nconst INITIAL_POST = {\n  photoUri: \"\",\n  titlePost: \"\",\n  location: {\n    latitude: \"\",\n    longitude: \"\",\n    postAddress: \"\",\n  },\n};\n\nexport default function CreatePostsScreen() {\n  // const dispatch = useDispatch();\n  const navigation = useNavigation();\n  const isFocused = useIsFocused();\n\n  const [isShowLoader, setIsShowLoader] = useState(false);\n  const [state, setState] = useState(INITIAL_POST);\n  const [isDirtyForm, setIsDirtyForm] = useState(false);\n  const [keyboardHeight, setKeyboardHeight] = useState(0);\n  // const [selectedPhoto, setSelectedPhoto] = useState(null);\n  // const [name, setName] = useState(\"\");\n  // const [writtenLocation, setWrittenLocation] = useState(\"\");\n  const [permissionCam, requestPermissionCam] = Camera.useCameraPermissions();\n  // const [hasPermission, setHasPermission] = useState(null);\n  const [cameraRef, setCameraRef] = useState(null);\n  const [buttonPressCount, setButtonPressCount] = useState(0);\n  const [type, setType] = useState(Camera.Constants.Type.back);\n  const userId = useSelector(selectStateUserId);\n  const avatar = useSelector(selectStateAvatar);\n  const login = useSelector(selectStateLogin);\n\n  useEffect(() => {\n    const unsubscribe = navigation.addListener(\"blur\", () => {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n    });\n    return unsubscribe;\n  }, []);\n\n  useEffect(() => {\n    navigation.setParams({\n      isDirtyForm,\n    });\n  }, [isDirtyForm]);\n\n  // useEffect(() => {\n  //   if (!isFocused) {\n  //     return;\n  //   }\n\n  //   (async () => {\n  //     // camera\n  //     try {\n  //       const { status } = await Camera.requestCameraPermissionsAsync();\n\n  //       if (status !== \"granted\") {\n  //         alert(\"Sorry, we need permissions to camera\");\n  //         return;\n  //       }\n  //     } catch (error) {\n  //       console.log(\"permission camera === >> \", error.message);\n  //     }\n\n  //     // location\n  //     try {\n  //       const { status } = await Location.requestForegroundPermissionsAsync();\n\n  //       if (status !== \"granted\") {\n  //         alert(\"Sorry, we need permissions to location\");\n  //         return;\n  //       }\n\n  //       const {\n  //         coords: { latitude, longitude },\n  //       } = await Location.getCurrentPositionAsync({});\n\n  //       const [postAddress] = await Location.reverseGeocodeAsync({\n  //         latitude,\n  //         longitude,\n  //       });\n\n  //       setState((prev) => ({\n  //         ...prev,\n  //         location: { latitude, longitude, postAddress },\n  //       }));\n  //     } catch (error) {\n  //       console.log(\"permission location === >> \", error.message);\n  //     }\n\n  //     // gallery\n  //     try {\n  //       if (Platform.OS !== \"web\") {\n  //         const { status } =\n  //           await ImagePicker.requestMediaLibraryPermissionsAsync();\n\n  //         if (status !== \"granted\") {\n  //           alert(\"Sorry, we need permissions to library\");\n  //         }\n  //       }\n  //     } catch (error) {\n  //       console.log(\"permission library === >> \", error.message);\n  //     }\n  //   })();\n  // }, [isFocused]);\n\n  // const handleDelete = () => {\n  //   setName(\"\");\n  //   setWrittenLocation(\"\");\n  //   setSelectedPhoto(null);\n  // };\n\n  // useEffect(() => {\n  //   handleDelete();\n  // }, []);\n\n  // useEffect(() => {\n  //   (async () => {\n  //     let { status } = await Location.requestForegroundPermissionsAsync();\n  //     if (status !== \"granted\") {\n  //       console.log(\"Permission to access location was denied\");\n  //     }\n\n  //     let location = await Location.getCurrentPositionAsync({});\n  //     const coords = {\n  //       latitude: location.coords.latitude,\n  //       longitude: location.coords.longitude,\n  //     };\n  //     dispatch(saveLocationAction(coords)).catch((error) => {\n  //       console.log(\"Ошибка при сохранении местоположения:\", error);\n  //     });\n  //   })();\n  // }, []);\n\n  useEffect(() => {\n    const keyboardDidShowListener = Keyboard.addListener(\n      \"keyboardDidShow\",\n      (event) => {\n        const { height } = event.endCoordinates;\n        setKeyboardHeight(height - 300);\n      }\n    );\n\n    const keyboardDidHideListener = Keyboard.addListener(\n      \"keyboardDidHide\",\n      () => {\n        setKeyboardHeight(0);\n      }\n    );\n\n    return () => {\n      keyboardDidShowListener.remove();\n      keyboardDidHideListener.remove();\n    };\n  }, []);\n\n  // useEffect(() => {\n  //   (async () => {\n  //     const { status } = await Camera.requestCameraPermissionsAsync();\n  //     await MediaLibrary.requestPermissionsAsync();\n\n  //     setHasPermission(status === \"granted\");\n  //   })();\n  // }, []);\n\n  // if (hasPermission === null) {\n  //   return <View />;\n  // }\n  // if (hasPermission === false) {\n  //   return <Text>No access to camera</Text>;\n  // }\n\n  const handleCameraPress = async () => {\n    ActionSheetIOS.showActionSheetWithOptions(\n      {\n        options: [\"Сделать фото\", \"Выбрать из галереи\", \"Отмена\"],\n        cancelButtonIndex: 2,\n      },\n      async (buttonIndex) => {\n        if (buttonIndex === 0) {\n          // Проверяем доступность камеры\n          const { status } = await Camera.requestCameraPermissionsAsync();\n          if (status === \"granted\") {\n            if (buttonPressCount === 0) {\n              takePhoto();\n              // const { uri } = await cameraRef.takePictureAsync();\n              // await MediaLibrary.createAssetAsync(uri);\n              // console.log(uri);\n              // console.log(selectedPhoto);\n              // setSelectedPhoto(uri);\n            } else if (buttonPressCount === 1) {\n              setState((prev) => ({ ...prev, photoUri: \"\" }));\n              takePhoto();\n              // const { uri } = await cameraRef.takePictureAsync();\n              // await MediaLibrary.createAssetAsync(uri);\n              // console.log(uri);\n              // console.log(selectedPhoto);\n              // setSelectedPhoto(uri);\n            }\n          } else {\n            // Разрешение на использование камеры не было предоставлено\n            console.log(\n              \"Разрешение на использование камеры не было предоставлено\"\n            );\n          }\n        } else if (buttonIndex === 1) {\n          // Выбрать из галереи\n          const { status } =\n            await ImagePicker.requestMediaLibraryPermissionsAsync();\n          if (status === \"granted\") {\n            const result = await ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.Images,\n              allowsEditing: true,\n              aspect: [1, 1],\n              quality: 1,\n            });\n\n            if (!result.canceled) {\n              const selectedAsset = await MediaLibrary.createAssetAsync(\n                result.assets[0].uri\n              );\n              const selectedUri = await MediaLibrary.getAssetInfoAsync(\n                selectedAsset\n              );\n              setState((prev) => ({ ...prev, photoUri: selectedUri.uri }));\n              // setSelectedPhoto(selectedUri.uri);\n              //   console.log(selectedUri.uri);\n            }\n          }\n        }\n        setButtonPressCount(1);\n      }\n    );\n  };\n\n  // if (isShowLoader) {\n  //   return <LoaderScreen />;\n  // }\n\n  // if (!permissionCam) {\n  //   return <LoaderScreen />;\n  // }\n\n  if (!permissionCam.granted) {\n    return (\n      <View style={styles.permission}>\n        <Text style={{ textAlign: \"center\" }}>\n          We need your permission to show the camera\n        </Text>\n        <CustomButton onPress={requestPermissionCam} title=\"grant permission\" />\n      </View>\n    );\n  }\n  const takePhoto = async () => {\n    if (cameraRef) {\n      try {\n        const { uri } = await cameraRef.current.takePictureAsync();\n\n        const newUri = await ImageManipulator(\n          uri,\n          [\n            {\n              resize: { height: 480, width: 680 },\n            },\n          ],\n          0.5\n        );\n\n        setState((prev) => ({\n          ...prev,\n          photoUri: newUri,\n        }));\n\n        setIsDirtyForm(true);\n      } catch (error) {\n        console.log(\"takePhoto ===>>> \", error.message);\n      }\n    }\n  };\n\n  const pickImage = async () => {\n    try {\n      const { assets, canceled } = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: true,\n        aspect: [4, 3],\n        quality: 1,\n      });\n\n      if (!canceled) {\n        const [{ uri }] = assets;\n\n        const newUri = await ImageManipulator(\n          uri,\n          [\n            {\n              resize: { height: 480, width: 680 },\n            },\n          ],\n          0.5\n        );\n\n        setState((prev) => ({\n          ...prev,\n          photoUri: newUri,\n        }));\n\n        setIsDirtyForm(true);\n      }\n    } catch (error) {\n      console.log(\"pickImage ====>> \", error.message);\n    }\n  };\n\n  const draggableMarker = async ({ latitude, longitude }) => {\n    const time = Date.now().toString();\n    try {\n      const [postAddress] = await Location.reverseGeocodeAsync({\n        latitude,\n        longitude,\n      });\n\n      setState((prev) => ({\n        ...prev,\n        location: { latitude, longitude, postAddress, time },\n      }));\n    } catch (error) {\n      console.log(\"draggableMarker ====>> \", error.message);\n    }\n  };\n\n  const uploadPhotoToServer = async () => {\n    const uniquePostId = Date.now().toString();\n\n    try {\n      const response = await fetch(state.photoUri);\n\n      const file = await response.blob();\n\n      const imageRef = ref(storage, `postImages/${uniquePostId}`);\n\n      const q = await uploadBytes(imageRef, file);\n\n      const link = await getDownloadURL(imageRef);\n\n      return link;\n    } catch (error) {\n      console.log(\"uploadPhotoToServer =====>> \", error);\n      alert(\"Вибачте, але фото не зберіглось на сервері\", error.message);\n    }\n  };\n\n  const uploadPostToServer = async () => {\n    setIsShowLoader(true);\n\n    const uniquePostId = Date.now().toString();\n\n    try {\n      const photo = await uploadPhotoToServer();\n      const postRef = doc(db, \"posts\", uniquePostId);\n\n      await setDoc(postRef, {\n        photo,\n        titlePost: state.titlePost ? state.titlePost : \"Незабутня подія\",\n        location: state.location,\n        createdAt: Timestamp.fromDate(new Date()),\n        updatedAt: Timestamp.fromDate(new Date()),\n        owner: {\n          userId,\n          login,\n          avatar,\n        },\n      });\n    } catch (error) {\n      console.log(\"uploadPostToServer ===>>\", error);\n      alert(\"Вибачте, але публікація не зберіглась на сервері\", error.message);\n    } finally {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n      setIsShowLoader(false);\n      navigation.navigate(\"PostsScreen\", { screen: \"Posts\" });\n    }\n  };\n\n  return (\n    <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\n      <View style={styles.main}>\n        <View style={styles.parent}>\n          <View>\n            {buttonPressCount == 0 ? (\n              <View style={styles.camera} ref={setCameraRef}>\n                <View style={styles.photoViewSelected}>\n                  <TouchableOpacity\n                    style={[\n                      styles.cameraButtonSelected,\n                      { backgroundColor: \"lightgrey\" },\n                    ]}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#fff\" />\n                  </TouchableOpacity>\n                </View>\n              </View>\n            ) : state.photoUri ? (\n              <ImageBackground\n                source={{ uri: state.photoUri }}\n                style={styles.camera}\n                ref={setCameraRef}\n              >\n                <View style={styles.photoViewSelected}>\n                  <TouchableOpacity\n                    style={styles.cameraButtonSelected}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#fff\" />\n                  </TouchableOpacity>\n                </View>\n              </ImageBackground>\n            ) : (\n              <Camera style={styles.camera} type={type} ref={setCameraRef}>\n                <View style={styles.photoView}>\n                  <TouchableOpacity\n                    style={styles.flipContainer}\n                    onPress={() => {\n                      setType(\n                        type === Camera.Constants.Type.back\n                          ? Camera.Constants.Type.front\n                          : Camera.Constants.Type.back\n                      );\n                    }}\n                  >\n                    <Feather name=\"repeat\" size={20} color=\"#BDBDBD\" />\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    style={styles.cameraButton}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#BDBDBD\" />\n                  </TouchableOpacity>\n                </View>\n              </Camera>\n            )}\n          </View>\n\n          {/* {selectedPhoto !== null ? (\n            <Text style={styles.text}>Редагувати фото</Text>\n          ) : (\n            <Text style={styles.text}>Завантажте фото</Text>\n          )} */}\n\n          {state.photoUri !== \"\" ? (\n            <TouchableOpacity\n              onPress={() => setState((prev) => ({ ...prev, photoUri: \"\" }))}\n            >\n              <Text style={styles.text}>Редагувати фото</Text>\n            </TouchableOpacity>\n          ) : (\n            <TouchableOpacity onPress={pickImage}>\n              <Text style={styles.text}>Завантажити фото</Text>\n            </TouchableOpacity>\n          )}\n\n          <View style={{ marginTop: -keyboardHeight }}>\n            <KeyboardAvoidingView\n              behavior={Platform.OS == \"ios\" ? \"padding\" : \"height\"}\n            >\n              <Input\n                placeholder=\"Назва...\"\n                value={state.titlePost}\n                onChangeText={(value) => {\n                  setState((prev) => ({ ...prev, titlePost: value }));\n                  setIsDirtyForm(value.length > 0 ? true : false);\n                }}\n              />\n              <Ionicons\n                style={{\n                  position: \"absolute\",\n                  top: 10,\n                  left: 10,\n                }}\n                name=\"attach\"\n                size={25}\n                color=\"#BDBDBD\"\n              />\n              <Input\n                placeholder=\"Місцевість...\"\n                value={state.location?.title}\n                onChangeText={(value) => {\n                  setState((prev) => ({\n                    ...prev,\n                    location: { ...prev.location, title: value },\n                  }));\n                  setIsDirtyForm(value.length > 0 ? true : false);\n                }}\n              />\n              <Ionicons\n                style={{\n                  position: \"absolute\",\n                  top: 80,\n                  left: 10,\n                }}\n                name=\"navigate\"\n                size={20}\n                color=\"#BDBDBD\"\n              />\n            </KeyboardAvoidingView>\n          </View>\n          {state.photoUri !== \"\" &&\n          state.location !== \"\" &&\n          state.titlePost !== \"\" ? (\n            <CustomButton text=\"Опублікувати\" onPress={uploadPostToServer} />\n          ) : (\n            <UnactiveButton text=\"Опублікувати\" />\n          )}\n\n          <View style={styles.delete}>\n            <UnactiveButton width={70} onPress={() => setState(INITIAL_POST)} />\n            <Ionicons\n              style={{\n                position: \"absolute\",\n                top: 25,\n                left: 22,\n              }}\n              name=\"trash\"\n              size={25}\n              color=\"#BDBDBD\"\n            />\n          </View>\n        </View>\n      </View>\n    </TouchableWithoutFeedback>\n  );\n}\n\nconst styles = StyleSheet.create({\n  main: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    borderColor: \"grey\",\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n  },\n  parent: {\n    marginHorizontal: 20,\n    marginVertical: 40,\n  },\n  container: {\n    flex: 1,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  camera: {\n    // width: 350,\n    width: \"100%\",\n    height: 240,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#f6f6f6\",\n    borderColor: \"#E8E8E8\",\n    borderWidth: 1,\n    borderRadius: 8,\n    overflow: \"hidden\",\n  },\n  cameraButton: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"#fff\",\n    borderRadius: \"50%\",\n  },\n  photoView: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    justifyContent: \"center\",\n  },\n  cameraButtonSelected: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"rgba(255, 255, 255, 0.3);\",\n    borderRadius: \"50%\",\n  },\n  photoViewSelected: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    marginTop: 90,\n  },\n  flipContainer: {\n    position: \"absolute\",\n    top: 10,\n    right: -120,\n  },\n  text: {\n    color: \"#BDBDBD\",\n    marginLeft: 10,\n    marginTop: 10,\n    marginBottom: 20,\n  },\n  placeholderContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  placeholderText: {\n    marginLeft: 5,\n    color: \"#BDBDBD\",\n  },\n  delete: {\n    position: \"absolute\",\n    top: \"130%\",\n    right: \"28%\",\n    transform: [{ translateX: -50 }, { translateY: -50 }],\n    // bottom: -180,\n    // left: 130,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\n"],"mappings":";;;;;AAAA,SAASA,QAAQ,EAAEC,OAAO,QAAQ,oBAAoB;AACtD,OAAOC,KAAK;AACZ,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,YAAY,QAAQ,0BAA0B;AAAC,OAAAC,IAAA;AAAA,OAAAC,IAAA;AAAA,OAAAC,gBAAA;AAAA,OAAAC,UAAA;AAAA,OAAAC,wBAAA;AAAA,OAAAC,QAAA;AAAA,OAAAC,oBAAA;AAAA,OAAAC,QAAA;AAAA,OAAAC,eAAA;AAYxD,SACEC,iBAAiB,EACjBC,iBAAiB,EACjBC,gBAAgB;AAElB,SAASC,EAAE,EAAEC,OAAO;AACpB,SAASC,GAAG,EAAEC,WAAW,EAAEC,cAAc,QAAQ,kBAAkB;AACnE,SAASC,GAAG,EAAEC,MAAM,EAAEC,SAAS,QAAQ,oBAAoB;AAE3D,SAASC,MAAM,QAAQ,aAAa;AACpC,OAAOC,YAAY,IAAIC,cAAc;AAA+B,SAC3DC,cAAc;AACvB,OAAO,KAAKC,WAAW,MAAM,mBAAmB;AAChD,OAAO,KAAKC,YAAY,MAAM,oBAAoB;AAClD,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,SAASC,aAAa,QAAQ,0BAA0B;AAQxD,SAASC,YAAY;AAAkC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAEvD,IAAMC,YAAY,GAAG;EACnBC,QAAQ,EAAE,EAAE;EACZC,SAAS,EAAE,EAAE;EACbC,QAAQ,EAAE;IACRC,QAAQ,EAAE,EAAE;IACZC,SAAS,EAAE,EAAE;IACbC,WAAW,EAAE;EACf;AACF,CAAC;AAED,eAAe,SAASC,iBAAiBA,CAAA,EAAG;EAAA,IAAAC,eAAA;EAE1C,IAAMC,UAAU,GAAGf,aAAa,CAAC,CAAC;EAClC,IAAMgB,SAAS,GAAG5C,YAAY,CAAC,CAAC;EAEhC,IAAA6C,SAAA,GAAwChD,QAAQ,CAAC,KAAK,CAAC;IAAAiD,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAhDG,YAAY,GAAAF,UAAA;IAAEG,eAAe,GAAAH,UAAA;EACpC,IAAAI,UAAA,GAA0BrD,QAAQ,CAACqC,YAAY,CAAC;IAAAiB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAAzCE,KAAK,GAAAD,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EACtB,IAAAG,UAAA,GAAsCzD,QAAQ,CAAC,KAAK,CAAC;IAAA0D,UAAA,GAAAR,cAAA,CAAAO,UAAA;IAA9CE,WAAW,GAAAD,UAAA;IAAEE,cAAc,GAAAF,UAAA;EAClC,IAAAG,UAAA,GAA4C7D,QAAQ,CAAC,CAAC,CAAC;IAAA8D,UAAA,GAAAZ,cAAA,CAAAW,UAAA;IAAhDE,cAAc,GAAAD,UAAA;IAAEE,iBAAiB,GAAAF,UAAA;EAIxC,IAAAG,qBAAA,GAA8CzC,MAAM,CAAC0C,oBAAoB,CAAC,CAAC;IAAAC,sBAAA,GAAAjB,cAAA,CAAAe,qBAAA;IAApEG,aAAa,GAAAD,sBAAA;IAAEE,oBAAoB,GAAAF,sBAAA;EAE1C,IAAAG,UAAA,GAAkCtE,QAAQ,CAAC,IAAI,CAAC;IAAAuE,WAAA,GAAArB,cAAA,CAAAoB,UAAA;IAAzCE,SAAS,GAAAD,WAAA;IAAEE,YAAY,GAAAF,WAAA;EAC9B,IAAAG,WAAA,GAAgD1E,QAAQ,CAAC,CAAC,CAAC;IAAA2E,WAAA,GAAAzB,cAAA,CAAAwB,WAAA;IAApDE,gBAAgB,GAAAD,WAAA;IAAEE,mBAAmB,GAAAF,WAAA;EAC5C,IAAAG,WAAA,GAAwB9E,QAAQ,CAACwB,MAAM,CAACuD,SAAS,CAACC,IAAI,CAACC,IAAI,CAAC;IAAAC,WAAA,GAAAhC,cAAA,CAAA4B,WAAA;IAArDK,IAAI,GAAAD,WAAA;IAAEE,OAAO,GAAAF,WAAA;EACpB,IAAMG,MAAM,GAAGnF,WAAW,CAACW,iBAAiB,CAAC;EAC7C,IAAMyE,MAAM,GAAGpF,WAAW,CAACY,iBAAiB,CAAC;EAC7C,IAAMyE,KAAK,GAAGrF,WAAW,CAACa,gBAAgB,CAAC;EAE3Cd,SAAS,CAAC,YAAM;IACd,IAAMuF,WAAW,GAAG1C,UAAU,CAAC2C,WAAW,CAAC,MAAM,EAAE,YAAM;MACvDjC,QAAQ,CAACnB,YAAY,CAAC;MACtBuB,cAAc,CAAC,KAAK,CAAC;IACvB,CAAC,CAAC;IACF,OAAO4B,WAAW;EACpB,CAAC,EAAE,EAAE,CAAC;EAENvF,SAAS,CAAC,YAAM;IACd6C,UAAU,CAAC4C,SAAS,CAAC;MACnB/B,WAAW,EAAXA;IACF,CAAC,CAAC;EACJ,CAAC,EAAE,CAACA,WAAW,CAAC,CAAC;EA0FjB1D,SAAS,CAAC,YAAM;IACd,IAAM0F,uBAAuB,GAAGlF,QAAQ,CAACgF,WAAW,CAClD,iBAAiB,EACjB,UAACG,KAAK,EAAK;MACT,IAAQC,MAAM,GAAKD,KAAK,CAACE,cAAc,CAA/BD,MAAM;MACd7B,iBAAiB,CAAC6B,MAAM,GAAG,GAAG,CAAC;IACjC,CACF,CAAC;IAED,IAAME,uBAAuB,GAAGtF,QAAQ,CAACgF,WAAW,CAClD,iBAAiB,EACjB,YAAM;MACJzB,iBAAiB,CAAC,CAAC,CAAC;IACtB,CACF,CAAC;IAED,OAAO,YAAM;MACX2B,uBAAuB,CAACK,MAAM,CAAC,CAAC;MAChCD,uBAAuB,CAACC,MAAM,CAAC,CAAC;IAClC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAkBN,IAAMC,iBAAiB;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAAY;MACpCxE,cAAc,CAACyE,0BAA0B,CACvC;QACEC,OAAO,EAAE,CAAC,cAAc,EAAE,oBAAoB,EAAE,QAAQ,CAAC;QACzDC,iBAAiB,EAAE;MACrB,CAAC;QAAA,IAAAC,KAAA,GAAAJ,iBAAA,CACD,WAAOK,WAAW,EAAK;UACrB,IAAIA,WAAW,KAAK,CAAC,EAAE;YAErB,IAAAC,qBAAA,SAAyBjF,MAAM,CAACkF,6BAA6B,CAAC,CAAC;cAAvDC,MAAM,GAAAF,qBAAA,CAANE,MAAM;YACd,IAAIA,MAAM,KAAK,SAAS,EAAE;cACxB,IAAI/B,gBAAgB,KAAK,CAAC,EAAE;gBAC1BgC,SAAS,CAAC,CAAC;cAMb,CAAC,MAAM,IAAIhC,gBAAgB,KAAK,CAAC,EAAE;gBACjCpB,QAAQ,CAAC,UAACqD,IAAI;kBAAA,OAAAC,aAAA,CAAAA,aAAA,KAAWD,IAAI;oBAAEvE,QAAQ,EAAE;kBAAE;gBAAA,CAAG,CAAC;gBAC/CsE,SAAS,CAAC,CAAC;cAMb;YACF,CAAC,MAAM;cAELG,OAAO,CAACC,GAAG,CACT,0DACF,CAAC;YACH;UACF,CAAC,MAAM,IAAIR,WAAW,KAAK,CAAC,EAAE;YAE5B,IAAAS,qBAAA,SACQrF,WAAW,CAACsF,mCAAmC,CAAC,CAAC;cADjDP,OAAM,GAAAM,qBAAA,CAANN,MAAM;YAEd,IAAIA,OAAM,KAAK,SAAS,EAAE;cACxB,IAAMQ,MAAM,SAASvF,WAAW,CAACwF,uBAAuB,CAAC;gBACvDC,UAAU,EAAEzF,WAAW,CAAC0F,gBAAgB,CAACC,MAAM;gBAC/CC,aAAa,EAAE,IAAI;gBACnBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;gBACdC,OAAO,EAAE;cACX,CAAC,CAAC;cAEF,IAAI,CAACP,MAAM,CAACQ,QAAQ,EAAE;gBACpB,IAAMC,aAAa,SAAS/F,YAAY,CAACgG,gBAAgB,CACvDV,MAAM,CAACW,MAAM,CAAC,CAAC,CAAC,CAACC,GACnB,CAAC;gBACD,IAAMC,WAAW,SAASnG,YAAY,CAACoG,iBAAiB,CACtDL,aACF,CAAC;gBACDpE,QAAQ,CAAC,UAACqD,IAAI;kBAAA,OAAAC,aAAA,CAAAA,aAAA,KAAWD,IAAI;oBAAEvE,QAAQ,EAAE0F,WAAW,CAACD;kBAAG;gBAAA,CAAG,CAAC;cAG9D;YACF;UACF;UACAlD,mBAAmB,CAAC,CAAC,CAAC;QACxB,CAAC;QAAA,iBAAAqD,EAAA;UAAA,OAAA3B,KAAA,CAAA4B,KAAA,OAAAC,SAAA;QAAA;MAAA,GACH,CAAC;IACH,CAAC;IAAA,gBA7DKnC,iBAAiBA,CAAA;MAAA,OAAAC,IAAA,CAAAiC,KAAA,OAAAC,SAAA;IAAA;EAAA,GA6DtB;EAUD,IAAI,CAAChE,aAAa,CAACiE,OAAO,EAAE;IAC1B,OACEjG,KAAA,CAAC/B,IAAI;MAACiI,KAAK,EAAEC,MAAM,CAACC,UAAW;MAAAC,QAAA,GAC7BvG,IAAA,CAAC9B,IAAI;QAACkI,KAAK,EAAE;UAAEI,SAAS,EAAE;QAAS,CAAE;QAAAD,QAAA,EAAC;MAEtC,CAAM,CAAC,EACPvG,IAAA,CAACT,YAAY;QAACkH,OAAO,EAAEtE,oBAAqB;QAACuE,KAAK,EAAC;MAAkB,CAAE,CAAC;IAAA,CACpE,CAAC;EAEX;EACA,IAAMhC,SAAS;IAAA,IAAAiC,KAAA,GAAA1C,iBAAA,CAAG,aAAY;MAC5B,IAAI3B,SAAS,EAAE;QACb,IAAI;UACF,IAAAsE,qBAAA,SAAsBtE,SAAS,CAACuE,OAAO,CAACC,gBAAgB,CAAC,CAAC;YAAlDjB,GAAG,GAAAe,qBAAA,CAAHf,GAAG;UAEX,IAAMkB,MAAM,SAASC,gBAAgB,CACnCnB,GAAG,EACH,CACE;YACEoB,MAAM,EAAE;cAAEtD,MAAM,EAAE,GAAG;cAAEuD,KAAK,EAAE;YAAI;UACpC,CAAC,CACF,EACD,GACF,CAAC;UAED5F,QAAQ,CAAC,UAACqD,IAAI;YAAA,OAAAC,aAAA,CAAAA,aAAA,KACTD,IAAI;cACPvE,QAAQ,EAAE2G;YAAM;UAAA,CAChB,CAAC;UAEHrF,cAAc,CAAC,IAAI,CAAC;QACtB,CAAC,CAAC,OAAOyF,KAAK,EAAE;UACdtC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEqC,KAAK,CAACC,OAAO,CAAC;QACjD;MACF;IACF,CAAC;IAAA,gBAzBK1C,SAASA,CAAA;MAAA,OAAAiC,KAAA,CAAAV,KAAA,OAAAC,SAAA;IAAA;EAAA,GAyBd;EAED,IAAMmB,SAAS;IAAA,IAAAC,KAAA,GAAArD,iBAAA,CAAG,aAAY;MAC5B,IAAI;QACF,IAAAsD,qBAAA,SAAmC7H,WAAW,CAACwF,uBAAuB,CAAC;YACrEC,UAAU,EAAEzF,WAAW,CAAC0F,gBAAgB,CAACoC,GAAG;YAC5ClC,aAAa,EAAE,IAAI;YACnBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;YACdC,OAAO,EAAE;UACX,CAAC,CAAC;UALMI,MAAM,GAAA2B,qBAAA,CAAN3B,MAAM;UAAEH,QAAQ,GAAA8B,qBAAA,CAAR9B,QAAQ;QAOxB,IAAI,CAACA,QAAQ,EAAE;UACb,IAAAgC,OAAA,GAAAzG,cAAA,CAAkB4E,MAAM;YAAfC,GAAG,GAAA4B,OAAA,IAAH5B,GAAG;UAEZ,IAAMkB,MAAM,SAASC,gBAAgB,CACnCnB,GAAG,EACH,CACE;YACEoB,MAAM,EAAE;cAAEtD,MAAM,EAAE,GAAG;cAAEuD,KAAK,EAAE;YAAI;UACpC,CAAC,CACF,EACD,GACF,CAAC;UAED5F,QAAQ,CAAC,UAACqD,IAAI;YAAA,OAAAC,aAAA,CAAAA,aAAA,KACTD,IAAI;cACPvE,QAAQ,EAAE2G;YAAM;UAAA,CAChB,CAAC;UAEHrF,cAAc,CAAC,IAAI,CAAC;QACtB;MACF,CAAC,CAAC,OAAOyF,KAAK,EAAE;QACdtC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEqC,KAAK,CAACC,OAAO,CAAC;MACjD;IACF,CAAC;IAAA,gBAhCKC,SAASA,CAAA;MAAA,OAAAC,KAAA,CAAArB,KAAA,OAAAC,SAAA;IAAA;EAAA,GAgCd;EAED,IAAMwB,eAAe;IAAA,IAAAC,KAAA,GAAA1D,iBAAA,CAAG,WAAA2D,KAAA,EAAmC;MAAA,IAA1BrH,QAAQ,GAAAqH,KAAA,CAARrH,QAAQ;QAAEC,SAAS,GAAAoH,KAAA,CAATpH,SAAS;MAClD,IAAMqH,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;MAClC,IAAI;QACF,IAAAC,qBAAA,SAA4BrI,QAAQ,CAACsI,mBAAmB,CAAC;YACvD3H,QAAQ,EAARA,QAAQ;YACRC,SAAS,EAATA;UACF,CAAC,CAAC;UAAA2H,sBAAA,GAAAnH,cAAA,CAAAiH,qBAAA;UAHKxH,WAAW,GAAA0H,sBAAA;QAKlB7G,QAAQ,CAAC,UAACqD,IAAI;UAAA,OAAAC,aAAA,CAAAA,aAAA,KACTD,IAAI;YACPrE,QAAQ,EAAE;cAAEC,QAAQ,EAARA,QAAQ;cAAEC,SAAS,EAATA,SAAS;cAAEC,WAAW,EAAXA,WAAW;cAAEoH,IAAI,EAAJA;YAAK;UAAC;QAAA,CACpD,CAAC;MACL,CAAC,CAAC,OAAOV,KAAK,EAAE;QACdtC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEqC,KAAK,CAACC,OAAO,CAAC;MACvD;IACF,CAAC;IAAA,gBAfKM,eAAeA,CAAAU,GAAA;MAAA,OAAAT,KAAA,CAAA1B,KAAA,OAAAC,SAAA;IAAA;EAAA,GAepB;EAED,IAAMmC,mBAAmB;IAAA,IAAAC,KAAA,GAAArE,iBAAA,CAAG,aAAY;MACtC,IAAMsE,YAAY,GAAGT,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;MAE1C,IAAI;QACF,IAAMQ,QAAQ,SAASC,KAAK,CAACpH,KAAK,CAACjB,QAAQ,CAAC;QAE5C,IAAMsI,IAAI,SAASF,QAAQ,CAACG,IAAI,CAAC,CAAC;QAElC,IAAMC,QAAQ,GAAG5J,GAAG,CAACD,OAAO,kBAAgBwJ,YAAc,CAAC;QAE3D,IAAMM,CAAC,SAAS5J,WAAW,CAAC2J,QAAQ,EAAEF,IAAI,CAAC;QAE3C,IAAMI,IAAI,SAAS5J,cAAc,CAAC0J,QAAQ,CAAC;QAE3C,OAAOE,IAAI;MACb,CAAC,CAAC,OAAO3B,KAAK,EAAE;QACdtC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEqC,KAAK,CAAC;QAClD4B,KAAK,CAAC,4CAA4C,EAAE5B,KAAK,CAACC,OAAO,CAAC;MACpE;IACF,CAAC;IAAA,gBAnBKiB,mBAAmBA,CAAA;MAAA,OAAAC,KAAA,CAAArC,KAAA,OAAAC,SAAA;IAAA;EAAA,GAmBxB;EAED,IAAM8C,kBAAkB;IAAA,IAAAC,KAAA,GAAAhF,iBAAA,CAAG,aAAY;MACrC/C,eAAe,CAAC,IAAI,CAAC;MAErB,IAAMqH,YAAY,GAAGT,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;MAE1C,IAAI;QACF,IAAMkB,KAAK,SAASb,mBAAmB,CAAC,CAAC;QACzC,IAAMc,OAAO,GAAGhK,GAAG,CAACL,EAAE,EAAE,OAAO,EAAEyJ,YAAY,CAAC;QAE9C,MAAMnJ,MAAM,CAAC+J,OAAO,EAAE;UACpBD,KAAK,EAALA,KAAK;UACL7I,SAAS,EAAEgB,KAAK,CAAChB,SAAS,GAAGgB,KAAK,CAAChB,SAAS,GAAG,iBAAiB;UAChEC,QAAQ,EAAEe,KAAK,CAACf,QAAQ;UACxB8I,SAAS,EAAE/J,SAAS,CAACgK,QAAQ,CAAC,IAAIvB,IAAI,CAAC,CAAC,CAAC;UACzCwB,SAAS,EAAEjK,SAAS,CAACgK,QAAQ,CAAC,IAAIvB,IAAI,CAAC,CAAC,CAAC;UACzCyB,KAAK,EAAE;YACLpG,MAAM,EAANA,MAAM;YACNE,KAAK,EAALA,KAAK;YACLD,MAAM,EAANA;UACF;QACF,CAAC,CAAC;MACJ,CAAC,CAAC,OAAO+D,KAAK,EAAE;QACdtC,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEqC,KAAK,CAAC;QAC9C4B,KAAK,CAAC,kDAAkD,EAAE5B,KAAK,CAACC,OAAO,CAAC;MAC1E,CAAC,SAAS;QACR9F,QAAQ,CAACnB,YAAY,CAAC;QACtBuB,cAAc,CAAC,KAAK,CAAC;QACrBR,eAAe,CAAC,KAAK,CAAC;QACtBN,UAAU,CAAC4I,QAAQ,CAAC,aAAa,EAAE;UAAEC,MAAM,EAAE;QAAQ,CAAC,CAAC;MACzD;IACF,CAAC;IAAA,gBA9BKT,kBAAkBA,CAAA;MAAA,OAAAC,KAAA,CAAAhD,KAAA,OAAAC,SAAA;IAAA;EAAA,GA8BvB;EAED,OACElG,IAAA,CAAC1B,wBAAwB;IAACmI,OAAO,EAAElI,QAAQ,CAACmL,OAAQ;IAAAnD,QAAA,EAClDvG,IAAA,CAAC7B,IAAI;MAACiI,KAAK,EAAEC,MAAM,CAACsD,IAAK;MAAApD,QAAA,EACvBrG,KAAA,CAAC/B,IAAI;QAACiI,KAAK,EAAEC,MAAM,CAACuD,MAAO;QAAArD,QAAA,GACzBvG,IAAA,CAAC7B,IAAI;UAAAoI,QAAA,EACF7D,gBAAgB,IAAI,CAAC,GACpB1C,IAAA,CAAC7B,IAAI;YAACiI,KAAK,EAAEC,MAAM,CAACwD,MAAO;YAAC7K,GAAG,EAAEuD,YAAa;YAAAgE,QAAA,EAC5CvG,IAAA,CAAC7B,IAAI;cAACiI,KAAK,EAAEC,MAAM,CAACyD,iBAAkB;cAAAvD,QAAA,EACpCvG,IAAA,CAAC5B,gBAAgB;gBACfgI,KAAK,EAAE,CACLC,MAAM,CAAC0D,oBAAoB,EAC3B;kBAAEC,eAAe,EAAE;gBAAY,CAAC,CAChC;gBACFvD,OAAO,EAAE1C,iBAAkB;gBAAAwC,QAAA,EAE3BvG,IAAA,CAACtC,QAAQ;kBAACuM,IAAI,EAAC,QAAQ;kBAACC,IAAI,EAAE,EAAG;kBAACC,KAAK,EAAC;gBAAM,CAAE;cAAC,CACjC;YAAC,CACf;UAAC,CACH,CAAC,GACL9I,KAAK,CAACjB,QAAQ,GAChBJ,IAAA,CAACtB,eAAe;YACd0L,MAAM,EAAE;cAAEvE,GAAG,EAAExE,KAAK,CAACjB;YAAS,CAAE;YAChCgG,KAAK,EAAEC,MAAM,CAACwD,MAAO;YACrB7K,GAAG,EAAEuD,YAAa;YAAAgE,QAAA,EAElBvG,IAAA,CAAC7B,IAAI;cAACiI,KAAK,EAAEC,MAAM,CAACyD,iBAAkB;cAAAvD,QAAA,EACpCvG,IAAA,CAAC5B,gBAAgB;gBACfgI,KAAK,EAAEC,MAAM,CAAC0D,oBAAqB;gBACnCtD,OAAO,EAAE1C,iBAAkB;gBAAAwC,QAAA,EAE3BvG,IAAA,CAACtC,QAAQ;kBAACuM,IAAI,EAAC,QAAQ;kBAACC,IAAI,EAAE,EAAG;kBAACC,KAAK,EAAC;gBAAM,CAAE;cAAC,CACjC;YAAC,CACf;UAAC,CACQ,CAAC,GAElBnK,IAAA,CAACV,MAAM;YAAC8G,KAAK,EAAEC,MAAM,CAACwD,MAAO;YAAC5G,IAAI,EAAEA,IAAK;YAACjE,GAAG,EAAEuD,YAAa;YAAAgE,QAAA,EAC1DrG,KAAA,CAAC/B,IAAI;cAACiI,KAAK,EAAEC,MAAM,CAACgE,SAAU;cAAA9D,QAAA,GAC5BvG,IAAA,CAAC5B,gBAAgB;gBACfgI,KAAK,EAAEC,MAAM,CAACiE,aAAc;gBAC5B7D,OAAO,EAAE,SAAAA,QAAA,EAAM;kBACbvD,OAAO,CACLD,IAAI,KAAK3D,MAAM,CAACuD,SAAS,CAACC,IAAI,CAACC,IAAI,GAC/BzD,MAAM,CAACuD,SAAS,CAACC,IAAI,CAACyH,KAAK,GAC3BjL,MAAM,CAACuD,SAAS,CAACC,IAAI,CAACC,IAC5B,CAAC;gBACH,CAAE;gBAAAwD,QAAA,EAEFvG,IAAA,CAACrC,OAAO;kBAACsM,IAAI,EAAC,QAAQ;kBAACC,IAAI,EAAE,EAAG;kBAACC,KAAK,EAAC;gBAAS,CAAE;cAAC,CACnC,CAAC,EACnBnK,IAAA,CAAC5B,gBAAgB;gBACfgI,KAAK,EAAEC,MAAM,CAACmE,YAAa;gBAC3B/D,OAAO,EAAE1C,iBAAkB;gBAAAwC,QAAA,EAE3BvG,IAAA,CAACtC,QAAQ;kBAACuM,IAAI,EAAC,QAAQ;kBAACC,IAAI,EAAE,EAAG;kBAACC,KAAK,EAAC;gBAAS,CAAE;cAAC,CACpC,CAAC;YAAA,CACf;UAAC,CACD;QACT,CACG,CAAC,EAQN9I,KAAK,CAACjB,QAAQ,KAAK,EAAE,GACpBJ,IAAA,CAAC5B,gBAAgB;UACfqI,OAAO,EAAE,SAAAA,QAAA;YAAA,OAAMnF,QAAQ,CAAC,UAACqD,IAAI;cAAA,OAAAC,aAAA,CAAAA,aAAA,KAAWD,IAAI;gBAAEvE,QAAQ,EAAE;cAAE;YAAA,CAAG,CAAC;UAAA,CAAC;UAAAmG,QAAA,EAE/DvG,IAAA,CAAC9B,IAAI;YAACkI,KAAK,EAAEC,MAAM,CAACoE,IAAK;YAAAlE,QAAA,EAAC;UAAe,CAAM;QAAC,CAChC,CAAC,GAEnBvG,IAAA,CAAC5B,gBAAgB;UAACqI,OAAO,EAAEY,SAAU;UAAAd,QAAA,EACnCvG,IAAA,CAAC9B,IAAI;YAACkI,KAAK,EAAEC,MAAM,CAACoE,IAAK;YAAAlE,QAAA,EAAC;UAAgB,CAAM;QAAC,CACjC,CACnB,EAEDvG,IAAA,CAAC7B,IAAI;UAACiI,KAAK,EAAE;YAAEsE,SAAS,EAAE,CAAC7I;UAAe,CAAE;UAAA0E,QAAA,EAC1CrG,KAAA,CAAC1B,oBAAoB;YACnBmM,QAAQ,EAAElM,QAAQ,CAACmM,EAAE,IAAI,KAAK,GAAG,SAAS,GAAG,QAAS;YAAArE,QAAA,GAEtDvG,IAAA,CAACpC,KAAK;cACJiN,WAAW,EAAC,mCAAU;cACtBC,KAAK,EAAEzJ,KAAK,CAAChB,SAAU;cACvB0K,YAAY,EAAE,SAAAA,aAACD,KAAK,EAAK;gBACvBxJ,QAAQ,CAAC,UAACqD,IAAI;kBAAA,OAAAC,aAAA,CAAAA,aAAA,KAAWD,IAAI;oBAAEtE,SAAS,EAAEyK;kBAAK;gBAAA,CAAG,CAAC;gBACnDpJ,cAAc,CAACoJ,KAAK,CAACE,MAAM,GAAG,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC;cACjD;YAAE,CACH,CAAC,EACFhL,IAAA,CAACtC,QAAQ;cACP0I,KAAK,EAAE;gBACL6E,QAAQ,EAAE,UAAU;gBACpBC,GAAG,EAAE,EAAE;gBACPC,IAAI,EAAE;cACR,CAAE;cACFlB,IAAI,EAAC,QAAQ;cACbC,IAAI,EAAE,EAAG;cACTC,KAAK,EAAC;YAAS,CAChB,CAAC,EACFnK,IAAA,CAACpC,KAAK;cACJiN,WAAW,EAAC,iEAAe;cAC3BC,KAAK,GAAAnK,eAAA,GAAEU,KAAK,CAACf,QAAQ,qBAAdK,eAAA,CAAgB+F,KAAM;cAC7BqE,YAAY,EAAE,SAAAA,aAACD,KAAK,EAAK;gBACvBxJ,QAAQ,CAAC,UAACqD,IAAI;kBAAA,OAAAC,aAAA,CAAAA,aAAA,KACTD,IAAI;oBACPrE,QAAQ,EAAAsE,aAAA,CAAAA,aAAA,KAAOD,IAAI,CAACrE,QAAQ;sBAAEoG,KAAK,EAAEoE;oBAAK;kBAAE;gBAAA,CAC5C,CAAC;gBACHpJ,cAAc,CAACoJ,KAAK,CAACE,MAAM,GAAG,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC;cACjD;YAAE,CACH,CAAC,EACFhL,IAAA,CAACtC,QAAQ;cACP0I,KAAK,EAAE;gBACL6E,QAAQ,EAAE,UAAU;gBACpBC,GAAG,EAAE,EAAE;gBACPC,IAAI,EAAE;cACR,CAAE;cACFlB,IAAI,EAAC,UAAU;cACfC,IAAI,EAAE,EAAG;cACTC,KAAK,EAAC;YAAS,CAChB,CAAC;UAAA,CACkB;QAAC,CACnB,CAAC,EACN9I,KAAK,CAACjB,QAAQ,KAAK,EAAE,IACtBiB,KAAK,CAACf,QAAQ,KAAK,EAAE,IACrBe,KAAK,CAAChB,SAAS,KAAK,EAAE,GACpBL,IAAA,CAACT,YAAY;UAACkL,IAAI,EAAC,0EAAc;UAAChE,OAAO,EAAEuC;QAAmB,CAAE,CAAC,GAEjEhJ,IAAA,CAACR,cAAc;UAACiL,IAAI,EAAC;QAAc,CAAE,CACtC,EAEDvK,KAAA,CAAC/B,IAAI;UAACiI,KAAK,EAAEC,MAAM,CAAC+E,MAAO;UAAA7E,QAAA,GACzBvG,IAAA,CAACR,cAAc;YAAC0H,KAAK,EAAE,EAAG;YAACT,OAAO,EAAE,SAAAA,QAAA;cAAA,OAAMnF,QAAQ,CAACnB,YAAY,CAAC;YAAA;UAAC,CAAE,CAAC,EACpEH,IAAA,CAACtC,QAAQ;YACP0I,KAAK,EAAE;cACL6E,QAAQ,EAAE,UAAU;cACpBC,GAAG,EAAE,EAAE;cACPC,IAAI,EAAE;YACR,CAAE;YACFlB,IAAI,EAAC,OAAO;YACZC,IAAI,EAAE,EAAG;YACTC,KAAK,EAAC;UAAS,CAChB,CAAC;QAAA,CACE,CAAC;MAAA,CACH;IAAC,CACH;EAAC,CACiB,CAAC;AAE/B;AAEA,IAAM9D,MAAM,GAAGhI,UAAU,CAACgN,MAAM,CAAC;EAC/B1B,IAAI,EAAE;IACJ2B,IAAI,EAAE,CAAC;IACPtB,eAAe,EAAE,MAAM;IACvBuB,WAAW,EAAE,MAAM;IACnBC,cAAc,EAAE,CAAC;IACjBC,iBAAiB,EAAE;EACrB,CAAC;EACD7B,MAAM,EAAE;IACN8B,gBAAgB,EAAE,EAAE;IACpBC,cAAc,EAAE;EAClB,CAAC;EACDC,SAAS,EAAE;IACTN,IAAI,EAAE,CAAC;IACPO,OAAO,EAAE,MAAM;IACfC,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE;EACd,CAAC;EACDlC,MAAM,EAAE;IAEN3C,KAAK,EAAE,MAAM;IACbvD,MAAM,EAAE,GAAG;IACXkI,OAAO,EAAE,MAAM;IACfC,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE,QAAQ;IACpB/B,eAAe,EAAE,SAAS;IAC1BuB,WAAW,EAAE,SAAS;IACtBS,WAAW,EAAE,CAAC;IACdC,YAAY,EAAE,CAAC;IACfC,QAAQ,EAAE;EACZ,CAAC;EACD1B,YAAY,EAAE;IACZsB,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE,QAAQ;IACpB7E,KAAK,EAAE,EAAE;IACTvD,MAAM,EAAE,EAAE;IACVqG,eAAe,EAAE,MAAM;IACvBiC,YAAY,EAAE;EAChB,CAAC;EACD5B,SAAS,EAAE;IACTiB,IAAI,EAAE,CAAC;IACPtB,eAAe,EAAE,aAAa;IAC9B8B,cAAc,EAAE;EAClB,CAAC;EACD/B,oBAAoB,EAAE;IACpB+B,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE,QAAQ;IACpB7E,KAAK,EAAE,EAAE;IACTvD,MAAM,EAAE,EAAE;IACVqG,eAAe,EAAE,2BAA2B;IAC5CiC,YAAY,EAAE;EAChB,CAAC;EACDnC,iBAAiB,EAAE;IACjBwB,IAAI,EAAE,CAAC;IACPtB,eAAe,EAAE,aAAa;IAC9BU,SAAS,EAAE;EACb,CAAC;EACDJ,aAAa,EAAE;IACbW,QAAQ,EAAE,UAAU;IACpBC,GAAG,EAAE,EAAE;IACPiB,KAAK,EAAE,CAAC;EACV,CAAC;EACD1B,IAAI,EAAE;IACJN,KAAK,EAAE,SAAS;IAChBiC,UAAU,EAAE,EAAE;IACd1B,SAAS,EAAE,EAAE;IACb2B,YAAY,EAAE;EAChB,CAAC;EACDC,oBAAoB,EAAE;IACpBC,aAAa,EAAE,KAAK;IACpBR,UAAU,EAAE;EACd,CAAC;EACDS,eAAe,EAAE;IACfJ,UAAU,EAAE,CAAC;IACbjC,KAAK,EAAE;EACT,CAAC;EACDiB,MAAM,EAAE;IACNH,QAAQ,EAAE,UAAU;IACpBC,GAAG,EAAE,MAAM;IACXiB,KAAK,EAAE,KAAK;IACZM,SAAS,EAAE,CAAC;MAAEC,UAAU,EAAE,CAAC;IAAG,CAAC,EAAE;MAAEC,UAAU,EAAE,CAAC;IAAG,CAAC,CAAC;IAGrDd,OAAO,EAAE,MAAM;IACfC,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE;EACd;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}