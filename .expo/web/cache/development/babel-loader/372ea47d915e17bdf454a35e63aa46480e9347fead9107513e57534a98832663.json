{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { Ionicons, Feather } from \"@expo/vector-icons\";\nimport Input from \"../components/InputCreatePost\";\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useIsFocused } from \"@react-navigation/native\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport { selectStateUserId, selectStateAvatar, selectStateLogin } from \"../redux/selectors\";\nimport { db, storage } from \"../firebase/config\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { doc, setDoc, Timestamp } from \"firebase/firestore\";\nimport { Camera } from \"expo-camera\";\nimport CustomButton, { UnactiveButton } from \"../components/Button\";\nimport { ActionSheetIOS } from \"react-native-web/dist/index\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport * as Location from \"expo-location\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { LoaderScreen } from \"../Screens/LoaderScreen\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar INITIAL_POST = {\n  photoUri: \"\",\n  titlePost: \"\",\n  location: {\n    latitude: \"\",\n    longitude: \"\",\n    postAddress: \"\"\n  }\n};\nexport default function CreatePostsScreen() {\n  var _state$location;\n  var navigation = useNavigation();\n  var isFocused = useIsFocused();\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isShowLoader = _useState2[0],\n    setIsShowLoader = _useState2[1];\n  var _useState3 = useState(INITIAL_POST),\n    _useState4 = _slicedToArray(_useState3, 2),\n    state = _useState4[0],\n    setState = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isDirtyForm = _useState6[0],\n    setIsDirtyForm = _useState6[1];\n  var _useState7 = useState(0),\n    _useState8 = _slicedToArray(_useState7, 2),\n    keyboardHeight = _useState8[0],\n    setKeyboardHeight = _useState8[1];\n  var _Camera$useCameraPerm = Camera.useCameraPermissions(),\n    _Camera$useCameraPerm2 = _slicedToArray(_Camera$useCameraPerm, 2),\n    permissionCam = _Camera$useCameraPerm2[0],\n    requestPermissionCam = _Camera$useCameraPerm2[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    hasPermission = _useState10[0],\n    setHasPermission = _useState10[1];\n  var _useState11 = useState(null),\n    _useState12 = _slicedToArray(_useState11, 2),\n    cameraRef = _useState12[0],\n    setCameraRef = _useState12[1];\n  var _useState13 = useState(0),\n    _useState14 = _slicedToArray(_useState13, 2),\n    buttonPressCount = _useState14[0],\n    setButtonPressCount = _useState14[1];\n  var _useState15 = useState(Camera.Constants.Type.back),\n    _useState16 = _slicedToArray(_useState15, 2),\n    type = _useState16[0],\n    setType = _useState16[1];\n  var userId = useSelector(selectStateUserId);\n  var avatar = useSelector(selectStateAvatar);\n  var login = useSelector(selectStateLogin);\n  useEffect(function () {\n    var unsubscribe = navigation.addListener(\"blur\", function () {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n    });\n    return unsubscribe;\n  }, []);\n  useEffect(function () {\n    navigation.setParams({\n      isDirtyForm: isDirtyForm\n    });\n  }, [isDirtyForm]);\n  useEffect(function () {\n    if (!isFocused) {\n      return;\n    }\n    _asyncToGenerator(function* () {\n      try {\n        var _yield$Camera$request = yield Camera.requestCameraPermissionsAsync(),\n          status = _yield$Camera$request.status;\n        if (status !== \"granted\") {\n          alert(\"Sorry, we need permissions to camera\");\n          return;\n        }\n      } catch (error) {\n        console.log(\"permission camera === >> \", error.message);\n      }\n      try {\n        var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          _status = _yield$Location$reque.status;\n        if (_status !== \"granted\") {\n          alert(\"Sorry, we need permissions to location\");\n          return;\n        }\n        var _yield$Location$getCu = yield Location.getCurrentPositionAsync({}),\n          _yield$Location$getCu2 = _yield$Location$getCu.coords,\n          latitude = _yield$Location$getCu2.latitude,\n          longitude = _yield$Location$getCu2.longitude;\n        var _yield$Location$rever = yield Location.reverseGeocodeAsync({\n            latitude: latitude,\n            longitude: longitude\n          }),\n          _yield$Location$rever2 = _slicedToArray(_yield$Location$rever, 1),\n          postAddress = _yield$Location$rever2[0];\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            location: {\n              latitude: latitude,\n              longitude: longitude,\n              postAddress: postAddress\n            }\n          });\n        });\n      } catch (error) {\n        console.log(\"permission location === >> \", error.message);\n      }\n      try {\n        if (Platform.OS !== \"web\") {\n          var _yield$ImagePicker$re = yield ImagePicker.requestMediaLibraryPermissionsAsync(),\n            _status2 = _yield$ImagePicker$re.status;\n          if (_status2 !== \"granted\") {\n            alert(\"Sorry, we need permissions to library\");\n          }\n        }\n      } catch (error) {\n        console.log(\"permission library === >> \", error.message);\n      }\n    })();\n  }, [isFocused]);\n  useEffect(function () {\n    var keyboardDidShowListener = Keyboard.addListener(\"keyboardDidShow\", function (event) {\n      var height = event.endCoordinates.height;\n      setKeyboardHeight(height - 300);\n    });\n    var keyboardDidHideListener = Keyboard.addListener(\"keyboardDidHide\", function () {\n      setKeyboardHeight(0);\n    });\n    return function () {\n      keyboardDidShowListener.remove();\n      keyboardDidHideListener.remove();\n    };\n  }, []);\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$Camera$request2 = yield Camera.requestCameraPermissionsAsync(),\n        status = _yield$Camera$request2.status;\n      yield MediaLibrary.requestPermissionsAsync();\n      setHasPermission(status === \"granted\");\n    })();\n  }, []);\n  if (hasPermission === null) {\n    return _jsx(View, {});\n  }\n  if (hasPermission === false) {\n    return _jsx(Text, {\n      children: \"No access to camera\"\n    });\n  }\n  var handleCameraPress = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      ActionSheetIOS.showActionSheetWithOptions({\n        options: [\"Сделать фото\", \"Выбрать из галереи\", \"Отмена\"],\n        cancelButtonIndex: 2\n      }, function () {\n        var _ref4 = _asyncToGenerator(function* (buttonIndex) {\n          if (buttonIndex === 0) {\n            var _yield$Camera$request3 = yield Camera.requestCameraPermissionsAsync(),\n              status = _yield$Camera$request3.status;\n            if (status === \"granted\") {\n              if (buttonPressCount === 0) {\n                takePhoto();\n              } else if (buttonPressCount === 1) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    photoUri: \"\"\n                  });\n                });\n                takePhoto();\n              }\n            } else {\n              console.log(\"Разрешение на использование камеры не было предоставлено\");\n            }\n          } else if (buttonIndex === 1) {\n            var _yield$ImagePicker$re2 = yield ImagePicker.requestMediaLibraryPermissionsAsync(),\n              _status3 = _yield$ImagePicker$re2.status;\n            if (_status3 === \"granted\") {\n              var result = yield ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.Images,\n                allowsEditing: true,\n                aspect: [1, 1],\n                quality: 1\n              });\n              if (!result.canceled) {\n                var selectedAsset = yield MediaLibrary.createAssetAsync(result.assets[0].uri);\n                var selectedUri = yield MediaLibrary.getAssetInfoAsync(selectedAsset);\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    photoUri: selectedUri.uri\n                  });\n                });\n              }\n            }\n          }\n          setButtonPressCount(1);\n        });\n        return function (_x) {\n          return _ref4.apply(this, arguments);\n        };\n      }());\n    });\n    return function handleCameraPress() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  if (!permissionCam.granted) {\n    return _jsxs(View, {\n      style: styles.permission,\n      children: [_jsx(Text, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: \"We need your permission to show the camera\"\n      }), _jsx(CustomButton, {\n        onPress: requestPermissionCam,\n        title: \"grant permission\"\n      })]\n    });\n  }\n  var takePhoto = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      if (cameraRef) {\n        try {\n          var _yield$cameraRef$curr = yield cameraRef.current.takePictureAsync(),\n            uri = _yield$cameraRef$curr.uri;\n          var newUri = yield ImageManipulator(uri, [{\n            resize: {\n              height: 480,\n              width: 680\n            }\n          }], 0.5);\n          setState(function (prev) {\n            return _objectSpread(_objectSpread({}, prev), {}, {\n              photoUri: newUri\n            });\n          });\n          setIsDirtyForm(true);\n        } catch (error) {\n          console.log(\"takePhoto ===>>> \", error.message);\n        }\n      }\n    });\n    return function takePhoto() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var pickImage = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      try {\n        var _yield$ImagePicker$la = yield ImagePicker.launchImageLibraryAsync({\n            mediaTypes: ImagePicker.MediaTypeOptions.All,\n            allowsEditing: true,\n            aspect: [4, 3],\n            quality: 1\n          }),\n          assets = _yield$ImagePicker$la.assets,\n          canceled = _yield$ImagePicker$la.canceled;\n        if (!canceled) {\n          var _assets = _slicedToArray(assets, 1),\n            uri = _assets[0].uri;\n          var newUri = yield ImageManipulator(uri, [{\n            resize: {\n              height: 480,\n              width: 680\n            }\n          }], 0.5);\n          setState(function (prev) {\n            return _objectSpread(_objectSpread({}, prev), {}, {\n              photoUri: newUri\n            });\n          });\n          setIsDirtyForm(true);\n        }\n      } catch (error) {\n        console.log(\"pickImage ====>> \", error.message);\n      }\n    });\n    return function pickImage() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var draggableMarker = function () {\n    var _ref8 = _asyncToGenerator(function* (_ref7) {\n      var latitude = _ref7.latitude,\n        longitude = _ref7.longitude;\n      var time = Date.now().toString();\n      try {\n        var _yield$Location$rever3 = yield Location.reverseGeocodeAsync({\n            latitude: latitude,\n            longitude: longitude\n          }),\n          _yield$Location$rever4 = _slicedToArray(_yield$Location$rever3, 1),\n          postAddress = _yield$Location$rever4[0];\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            location: {\n              latitude: latitude,\n              longitude: longitude,\n              postAddress: postAddress,\n              time: time\n            }\n          });\n        });\n      } catch (error) {\n        console.log(\"draggableMarker ====>> \", error.message);\n      }\n    });\n    return function draggableMarker(_x2) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  var uploadPhotoToServer = function () {\n    var _ref9 = _asyncToGenerator(function* () {\n      var uniquePostId = Date.now().toString();\n      try {\n        var response = yield fetch(state.photoUri);\n        var file = yield response.blob();\n        var imageRef = ref(storage, \"postImages/\" + uniquePostId);\n        var q = yield uploadBytes(imageRef, file);\n        var link = yield getDownloadURL(imageRef);\n        return link;\n      } catch (error) {\n        console.log(\"uploadPhotoToServer =====>> \", error);\n        alert(\"Вибачте, але фото не зберіглось на сервері\", error.message);\n      }\n    });\n    return function uploadPhotoToServer() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n  var uploadPostToServer = function () {\n    var _ref10 = _asyncToGenerator(function* () {\n      setIsShowLoader(true);\n      var uniquePostId = Date.now().toString();\n      try {\n        var photo = yield uploadPhotoToServer();\n        var postRef = doc(db, \"posts\", uniquePostId);\n        yield setDoc(postRef, {\n          photo: photo,\n          titlePost: state.titlePost ? state.titlePost : \"Незабутня подія\",\n          location: state.location,\n          createdAt: Timestamp.fromDate(new Date()),\n          updatedAt: Timestamp.fromDate(new Date()),\n          owner: {\n            userId: userId,\n            login: login,\n            avatar: avatar\n          }\n        });\n      } catch (error) {\n        console.log(\"uploadPostToServer >\", error);\n        alert(\"Вибачте, але публікація не зберіглась на сервері\", error.message);\n      } finally {\n        setState(INITIAL_POST);\n        setIsDirtyForm(false);\n        setIsShowLoader(false);\n        navigation.navigate(\"PostsScreen\", {\n          screen: \"Posts\"\n        });\n      }\n    });\n    return function uploadPostToServer() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n  return _jsx(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    children: _jsx(View, {\n      style: styles.main,\n      children: _jsxs(View, {\n        style: styles.parent,\n        children: [_jsx(View, {\n          children: buttonPressCount == 0 ? _jsx(View, {\n            style: styles.camera,\n            ref: setCameraRef,\n            children: _jsx(View, {\n              style: styles.photoViewSelected,\n              children: _jsx(TouchableOpacity, {\n                style: [styles.cameraButtonSelected, {\n                  backgroundColor: \"lightgrey\"\n                }],\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#fff\"\n                })\n              })\n            })\n          }) : state.photoUri ? _jsx(ImageBackground, {\n            source: {\n              uri: state.photoUri\n            },\n            style: styles.camera,\n            ref: setCameraRef,\n            children: _jsx(View, {\n              style: styles.photoViewSelected,\n              children: _jsx(TouchableOpacity, {\n                style: styles.cameraButtonSelected,\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#fff\"\n                })\n              })\n            })\n          }) : _jsx(Camera, {\n            style: styles.camera,\n            type: type,\n            ref: setCameraRef,\n            children: _jsxs(View, {\n              style: styles.photoView,\n              children: [_jsx(TouchableOpacity, {\n                style: styles.flipContainer,\n                onPress: function onPress() {\n                  setType(type === Camera.Constants.Type.back ? Camera.Constants.Type.front : Camera.Constants.Type.back);\n                },\n                children: _jsx(Feather, {\n                  name: \"repeat\",\n                  size: 20,\n                  color: \"#BDBDBD\"\n                })\n              }), _jsx(TouchableOpacity, {\n                style: styles.cameraButton,\n                onPress: handleCameraPress,\n                children: _jsx(Ionicons, {\n                  name: \"camera\",\n                  size: 30,\n                  color: \"#BDBDBD\"\n                })\n              })]\n            })\n          })\n        }), state.photoUri !== \"\" ? _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return setState(function (prev) {\n              return _objectSpread(_objectSpread({}, prev), {}, {\n                photoUri: \"\"\n              });\n            });\n          },\n          children: _jsx(Text, {\n            style: styles.text,\n            children: \"\\u0420\\u0435\\u0434\\u0430\\u0433\\u0443\\u0432\\u0430\\u0442\\u0438 \\u0444\\u043E\\u0442\\u043E\"\n          })\n        }) : _jsx(TouchableOpacity, {\n          onPress: pickImage,\n          children: _jsx(Text, {\n            style: styles.text,\n            children: \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438 \\u0444\\u043E\\u0442\\u043E\"\n          })\n        }), _jsx(View, {\n          style: {\n            marginTop: -keyboardHeight\n          },\n          children: _jsxs(KeyboardAvoidingView, {\n            behavior: Platform.OS == \"ios\" ? \"padding\" : \"height\",\n            children: [_jsx(Input, {\n              placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430...\",\n              value: state.titlePost,\n              onChangeText: function onChangeText(value) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    titlePost: value\n                  });\n                });\n                setIsDirtyForm(value.length > 0 ? true : false);\n              }\n            }), _jsx(Ionicons, {\n              style: {\n                position: \"absolute\",\n                top: 10,\n                left: 10\n              },\n              name: \"attach\",\n              size: 25,\n              color: \"#BDBDBD\"\n            }), _jsx(Input, {\n              placeholder: \"\\u041C\\u0456\\u0441\\u0446\\u0435\\u0432\\u0456\\u0441\\u0442\\u044C...\",\n              value: (_state$location = state.location) == null ? void 0 : _state$location.title,\n              onChangeText: function onChangeText(value) {\n                setState(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    location: _objectSpread(_objectSpread({}, prev.location), {}, {\n                      title: value\n                    })\n                  });\n                });\n                setIsDirtyForm(value.length > 0 ? true : false);\n              }\n            }), _jsx(Ionicons, {\n              style: {\n                position: \"absolute\",\n                top: 80,\n                left: 10\n              },\n              name: \"navigate\",\n              size: 20,\n              color: \"#BDBDBD\"\n            })]\n          })\n        }), state.photoUri !== \"\" && state.location !== \"\" && state.titlePost !== \"\" ? _jsx(CustomButton, {\n          text: \"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0456\\u043A\\u0443\\u0432\\u0430\\u0442\\u0438\",\n          onPress: uploadPostToServer\n        }) : _jsx(UnactiveButton, {\n          text: \"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0456\\u043A\\u0443\\u0432\\u0430\\u0442\\u0438\"\n        }), _jsxs(View, {\n          style: styles.delete,\n          children: [_jsx(UnactiveButton, {\n            width: 70,\n            onPress: function onPress() {\n              return setState(INITIAL_POST);\n            }\n          }), _jsx(Ionicons, {\n            style: {\n              position: \"absolute\",\n              top: 25,\n              left: 22\n            },\n            name: \"trash\",\n            size: 25,\n            color: \"#BDBDBD\",\n            onPress: setState(INITIAL_POST)\n          })]\n        })]\n      })\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  main: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    borderColor: \"grey\",\n    borderTopWidth: 1,\n    borderBottomWidth: 1\n  },\n  parent: {\n    marginHorizontal: 20,\n    marginVertical: 40\n  },\n  container: {\n    flex: 1,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  camera: {\n    width: \"100%\",\n    height: 240,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#f6f6f6\",\n    borderColor: \"#E8E8E8\",\n    borderWidth: 1,\n    borderRadius: 8,\n    overflow: \"hidden\"\n  },\n  cameraButton: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"#fff\",\n    borderRadius: \"50%\"\n  },\n  photoView: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    justifyContent: \"center\"\n  },\n  cameraButtonSelected: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"rgba(255, 255, 255, 0.3);\",\n    borderRadius: \"50%\"\n  },\n  photoViewSelected: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    marginTop: 90\n  },\n  flipContainer: {\n    position: \"absolute\",\n    top: 10,\n    right: -120\n  },\n  text: {\n    color: \"#BDBDBD\",\n    marginLeft: 10,\n    marginTop: 10,\n    marginBottom: 20\n  },\n  placeholderContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  placeholderText: {\n    marginLeft: 5,\n    color: \"#BDBDBD\"\n  },\n  delete: {\n    position: \"absolute\",\n    top: \"130%\",\n    right: \"25%\",\n    transform: [{\n      translateX: -50\n    }, {\n      translateY: -50\n    }],\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"names":["Ionicons","Feather","Input","React","useState","useEffect","useSelector","useIsFocused","Text","View","TouchableOpacity","StyleSheet","TouchableWithoutFeedback","Keyboard","KeyboardAvoidingView","Platform","ImageBackground","selectStateUserId","selectStateAvatar","selectStateLogin","db","storage","ref","uploadBytes","getDownloadURL","doc","setDoc","Timestamp","Camera","CustomButton","UnactiveButton","ActionSheetIOS","ImagePicker","MediaLibrary","Location","useNavigation","LoaderScreen","jsx","_jsx","jsxs","_jsxs","INITIAL_POST","photoUri","titlePost","location","latitude","longitude","postAddress","CreatePostsScreen","_state$location","navigation","isFocused","_useState","_useState2","_slicedToArray","isShowLoader","setIsShowLoader","_useState3","_useState4","state","setState","_useState5","_useState6","isDirtyForm","setIsDirtyForm","_useState7","_useState8","keyboardHeight","setKeyboardHeight","_Camera$useCameraPerm","useCameraPermissions","_Camera$useCameraPerm2","permissionCam","requestPermissionCam","_useState9","_useState10","hasPermission","setHasPermission","_useState11","_useState12","cameraRef","setCameraRef","_useState13","_useState14","buttonPressCount","setButtonPressCount","_useState15","Constants","Type","back","_useState16","type","setType","userId","avatar","login","unsubscribe","addListener","setParams","_asyncToGenerator","_yield$Camera$request","requestCameraPermissionsAsync","status","alert","error","console","log","message","_yield$Location$reque","requestForegroundPermissionsAsync","_yield$Location$getCu","getCurrentPositionAsync","_yield$Location$getCu2","coords","_yield$Location$rever","reverseGeocodeAsync","_yield$Location$rever2","prev","_objectSpread","OS","_yield$ImagePicker$re","requestMediaLibraryPermissionsAsync","keyboardDidShowListener","event","height","endCoordinates","keyboardDidHideListener","remove","_yield$Camera$request2","requestPermissionsAsync","children","handleCameraPress","_ref3","showActionSheetWithOptions","options","cancelButtonIndex","_ref4","buttonIndex","_yield$Camera$request3","takePhoto","_yield$ImagePicker$re2","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","canceled","selectedAsset","createAssetAsync","assets","uri","selectedUri","getAssetInfoAsync","_x","apply","arguments","granted","style","styles","permission","textAlign","onPress","title","_ref5","_yield$cameraRef$curr","current","takePictureAsync","newUri","ImageManipulator","resize","width","pickImage","_ref6","_yield$ImagePicker$la","All","_assets","draggableMarker","_ref8","_ref7","time","Date","now","toString","_yield$Location$rever3","_yield$Location$rever4","_x2","uploadPhotoToServer","_ref9","uniquePostId","response","fetch","file","blob","imageRef","q","link","uploadPostToServer","_ref10","photo","postRef","createdAt","fromDate","updatedAt","owner","navigate","screen","dismiss","main","parent","camera","photoViewSelected","cameraButtonSelected","backgroundColor","name","size","color","source","photoView","flipContainer","front","cameraButton","text","marginTop","behavior","placeholder","value","onChangeText","length","position","top","left","delete","create","flex","borderColor","borderTopWidth","borderBottomWidth","marginHorizontal","marginVertical","container","display","justifyContent","alignItems","borderWidth","borderRadius","overflow","right","marginLeft","marginBottom","placeholderContainer","flexDirection","placeholderText","transform","translateX","translateY"],"sources":["/Users/Anastasia/Desktop/goit-react_native-hw-06-redux-firebase/src/Screens/CreatePostsScreen.js"],"sourcesContent":["import { Ionicons, Feather } from \"@expo/vector-icons\";\nimport Input from \"../components/InputCreatePost\";\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useIsFocused } from \"@react-navigation/native\";\nimport {\n  Text,\n  View,\n  TouchableOpacity,\n  StyleSheet,\n  TouchableWithoutFeedback,\n  Keyboard,\n  KeyboardAvoidingView,\n  Platform,\n  ImageBackground,\n} from \"react-native\";\nimport {\n  selectStateUserId,\n  selectStateAvatar,\n  selectStateLogin,\n} from \"../redux/selectors\";\nimport { db, storage } from \"../firebase/config\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { doc, setDoc, Timestamp } from \"firebase/firestore\";\n\nimport { Camera } from \"expo-camera\";\nimport CustomButton, { UnactiveButton } from \"../components/Button\";\nimport { ActionSheetIOS } from \"react-native\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport * as Location from \"expo-location\";\nimport { useNavigation } from \"@react-navigation/native\";\n// import { saveLocationAction } from \"../redux/post/postActions\";\n// import { writeDataToFirestore } from \"../../firebase/collections\";\n// import {\n//   savePostLocation,\n//   savePostName,\n//   savePostPhoto,\n// } from \"../redux/post/postActions\";\nimport { LoaderScreen } from \"../Screens/LoaderScreen\";\n\nconst INITIAL_POST = {\n  photoUri: \"\",\n  titlePost: \"\",\n  location: {\n    latitude: \"\",\n    longitude: \"\",\n    postAddress: \"\",\n  },\n};\n\nexport default function CreatePostsScreen() {\n  // const dispatch = useDispatch();\n  const navigation = useNavigation();\n  const isFocused = useIsFocused();\n\n  const [isShowLoader, setIsShowLoader] = useState(false);\n  const [state, setState] = useState(INITIAL_POST);\n  const [isDirtyForm, setIsDirtyForm] = useState(false);\n  const [keyboardHeight, setKeyboardHeight] = useState(0);\n  // const [selectedPhoto, setSelectedPhoto] = useState(null);\n  // const [name, setName] = useState(\"\");\n  // const [writtenLocation, setWrittenLocation] = useState(\"\");\n  const [permissionCam, requestPermissionCam] = Camera.useCameraPermissions();\n  const [hasPermission, setHasPermission] = useState(null);\n  const [cameraRef, setCameraRef] = useState(null);\n  const [buttonPressCount, setButtonPressCount] = useState(0);\n  const [type, setType] = useState(Camera.Constants.Type.back);\n  const userId = useSelector(selectStateUserId);\n  const avatar = useSelector(selectStateAvatar);\n  const login = useSelector(selectStateLogin);\n\n  useEffect(() => {\n    const unsubscribe = navigation.addListener(\"blur\", () => {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n    });\n    return unsubscribe;\n  }, []);\n\n  useEffect(() => {\n    navigation.setParams({\n      isDirtyForm,\n    });\n  }, [isDirtyForm]);\n\n  useEffect(() => {\n    if (!isFocused) {\n      return;\n    }\n\n    (async () => {\n      // camera\n      try {\n        const { status } = await Camera.requestCameraPermissionsAsync();\n\n        if (status !== \"granted\") {\n          alert(\"Sorry, we need permissions to camera\");\n          return;\n        }\n      } catch (error) {\n        console.log(\"permission camera === >> \", error.message);\n      }\n\n      // location\n      try {\n        const { status } = await Location.requestForegroundPermissionsAsync();\n\n        if (status !== \"granted\") {\n          alert(\"Sorry, we need permissions to location\");\n          return;\n        }\n\n        const {\n          coords: { latitude, longitude },\n        } = await Location.getCurrentPositionAsync({});\n\n        const [postAddress] = await Location.reverseGeocodeAsync({\n          latitude,\n          longitude,\n        });\n\n        setState((prev) => ({\n          ...prev,\n          location: { latitude, longitude, postAddress },\n        }));\n      } catch (error) {\n        console.log(\"permission location === >> \", error.message);\n      }\n\n      // gallery\n      try {\n        if (Platform.OS !== \"web\") {\n          const { status } =\n            await ImagePicker.requestMediaLibraryPermissionsAsync();\n\n          if (status !== \"granted\") {\n            alert(\"Sorry, we need permissions to library\");\n          }\n        }\n      } catch (error) {\n        console.log(\"permission library === >> \", error.message);\n      }\n    })();\n  }, [isFocused]);\n\n  // const handleDelete = () => {\n  //   setName(\"\");\n  //   setWrittenLocation(\"\");\n  //   setSelectedPhoto(null);\n  // };\n\n  // useEffect(() => {\n  //   handleDelete();\n  // }, []);\n\n  // useEffect(() => {\n  //   (async () => {\n  //     let { status } = await Location.requestForegroundPermissionsAsync();\n  //     if (status !== \"granted\") {\n  //       console.log(\"Permission to access location was denied\");\n  //     }\n\n  //     let location = await Location.getCurrentPositionAsync({});\n  //     const coords = {\n  //       latitude: location.coords.latitude,\n  //       longitude: location.coords.longitude,\n  //     };\n  //     dispatch(saveLocationAction(coords)).catch((error) => {\n  //       console.log(\"Ошибка при сохранении местоположения:\", error);\n  //     });\n  //   })();\n  // }, []);\n\n  useEffect(() => {\n    const keyboardDidShowListener = Keyboard.addListener(\n      \"keyboardDidShow\",\n      (event) => {\n        const { height } = event.endCoordinates;\n        setKeyboardHeight(height - 300);\n      }\n    );\n\n    const keyboardDidHideListener = Keyboard.addListener(\n      \"keyboardDidHide\",\n      () => {\n        setKeyboardHeight(0);\n      }\n    );\n\n    return () => {\n      keyboardDidShowListener.remove();\n      keyboardDidHideListener.remove();\n    };\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      const { status } = await Camera.requestCameraPermissionsAsync();\n      await MediaLibrary.requestPermissionsAsync();\n\n      setHasPermission(status === \"granted\");\n    })();\n  }, []);\n\n  if (hasPermission === null) {\n    return <View />;\n  }\n  if (hasPermission === false) {\n    return <Text>No access to camera</Text>;\n  }\n\n  const handleCameraPress = async () => {\n    ActionSheetIOS.showActionSheetWithOptions(\n      {\n        options: [\"Сделать фото\", \"Выбрать из галереи\", \"Отмена\"],\n        cancelButtonIndex: 2,\n      },\n      async (buttonIndex) => {\n        if (buttonIndex === 0) {\n          // Проверяем доступность камеры\n          const { status } = await Camera.requestCameraPermissionsAsync();\n          if (status === \"granted\") {\n            if (buttonPressCount === 0) {\n              takePhoto();\n              // const { uri } = await cameraRef.takePictureAsync();\n              // await MediaLibrary.createAssetAsync(uri);\n              // console.log(uri);\n              // console.log(selectedPhoto);\n              // setSelectedPhoto(uri);\n            } else if (buttonPressCount === 1) {\n              setState((prev) => ({ ...prev, photoUri: \"\" }));\n              takePhoto();\n              // const { uri } = await cameraRef.takePictureAsync();\n              // await MediaLibrary.createAssetAsync(uri);\n              // console.log(uri);\n              // console.log(selectedPhoto);\n              // setSelectedPhoto(uri);\n            }\n          } else {\n            // Разрешение на использование камеры не было предоставлено\n            console.log(\n              \"Разрешение на использование камеры не было предоставлено\"\n            );\n          }\n        } else if (buttonIndex === 1) {\n          // Выбрать из галереи\n          const { status } =\n            await ImagePicker.requestMediaLibraryPermissionsAsync();\n          if (status === \"granted\") {\n            const result = await ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.Images,\n              allowsEditing: true,\n              aspect: [1, 1],\n              quality: 1,\n            });\n\n            if (!result.canceled) {\n              const selectedAsset = await MediaLibrary.createAssetAsync(\n                result.assets[0].uri\n              );\n              const selectedUri = await MediaLibrary.getAssetInfoAsync(\n                selectedAsset\n              );\n              setState((prev) => ({ ...prev, photoUri: selectedUri.uri }));\n              // setSelectedPhoto(selectedUri.uri);\n              //   console.log(selectedUri.uri);\n            }\n          }\n        }\n        setButtonPressCount(1);\n      }\n    );\n  };\n\n  // if (isShowLoader) {\n  //   return <LoaderScreen />;\n  // }\n\n  // if (!permissionCam) {\n  //   return <LoaderScreen />;\n  // }\n\n  if (!permissionCam.granted) {\n    return (\n      <View style={styles.permission}>\n        <Text style={{ textAlign: \"center\" }}>\n          We need your permission to show the camera\n        </Text>\n        <CustomButton onPress={requestPermissionCam} title=\"grant permission\" />\n      </View>\n    );\n  }\n  const takePhoto = async () => {\n    if (cameraRef) {\n      try {\n        const { uri } = await cameraRef.current.takePictureAsync();\n\n        const newUri = await ImageManipulator(\n          uri,\n          [\n            {\n              resize: { height: 480, width: 680 },\n            },\n          ],\n          0.5\n        );\n\n        setState((prev) => ({\n          ...prev,\n          photoUri: newUri,\n        }));\n\n        setIsDirtyForm(true);\n      } catch (error) {\n        console.log(\"takePhoto ===>>> \", error.message);\n      }\n    }\n  };\n\n  const pickImage = async () => {\n    try {\n      const { assets, canceled } = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: true,\n        aspect: [4, 3],\n        quality: 1,\n      });\n\n      if (!canceled) {\n        const [{ uri }] = assets;\n\n        const newUri = await ImageManipulator(\n          uri,\n          [\n            {\n              resize: { height: 480, width: 680 },\n            },\n          ],\n          0.5\n        );\n\n        setState((prev) => ({\n          ...prev,\n          photoUri: newUri,\n        }));\n\n        setIsDirtyForm(true);\n      }\n    } catch (error) {\n      console.log(\"pickImage ====>> \", error.message);\n    }\n  };\n\n  const draggableMarker = async ({ latitude, longitude }) => {\n    const time = Date.now().toString();\n    try {\n      const [postAddress] = await Location.reverseGeocodeAsync({\n        latitude,\n        longitude,\n      });\n\n      setState((prev) => ({\n        ...prev,\n        location: { latitude, longitude, postAddress, time },\n      }));\n    } catch (error) {\n      console.log(\"draggableMarker ====>> \", error.message);\n    }\n  };\n\n  const uploadPhotoToServer = async () => {\n    const uniquePostId = Date.now().toString();\n\n    try {\n      const response = await fetch(state.photoUri);\n\n      const file = await response.blob();\n\n      const imageRef = ref(storage, `postImages/${uniquePostId}`);\n\n      const q = await uploadBytes(imageRef, file);\n\n      const link = await getDownloadURL(imageRef);\n\n      return link;\n    } catch (error) {\n      console.log(\"uploadPhotoToServer =====>> \", error);\n      alert(\"Вибачте, але фото не зберіглось на сервері\", error.message);\n    }\n  };\n\n  const uploadPostToServer = async () => {\n    setIsShowLoader(true);\n\n    const uniquePostId = Date.now().toString();\n\n    try {\n      const photo = await uploadPhotoToServer();\n      const postRef = doc(db, \"posts\", uniquePostId);\n\n      await setDoc(postRef, {\n        photo,\n        titlePost: state.titlePost ? state.titlePost : \"Незабутня подія\",\n        location: state.location,\n        createdAt: Timestamp.fromDate(new Date()),\n        updatedAt: Timestamp.fromDate(new Date()),\n        owner: {\n          userId,\n          login,\n          avatar,\n        },\n      });\n    } catch (error) {\n      console.log(\"uploadPostToServer >\", error);\n      alert(\"Вибачте, але публікація не зберіглась на сервері\", error.message);\n    } finally {\n      setState(INITIAL_POST);\n      setIsDirtyForm(false);\n      setIsShowLoader(false);\n      navigation.navigate(\"PostsScreen\", { screen: \"Posts\" });\n    }\n  };\n\n  return (\n    <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\n      <View style={styles.main}>\n        <View style={styles.parent}>\n          <View>\n            {buttonPressCount == 0 ? (\n              <View style={styles.camera} ref={setCameraRef}>\n                <View style={styles.photoViewSelected}>\n                  <TouchableOpacity\n                    style={[\n                      styles.cameraButtonSelected,\n                      { backgroundColor: \"lightgrey\" },\n                    ]}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#fff\" />\n                  </TouchableOpacity>\n                </View>\n              </View>\n            ) : state.photoUri ? (\n              <ImageBackground\n                source={{ uri: state.photoUri }}\n                style={styles.camera}\n                ref={setCameraRef}\n              >\n                <View style={styles.photoViewSelected}>\n                  <TouchableOpacity\n                    style={styles.cameraButtonSelected}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#fff\" />\n                  </TouchableOpacity>\n                </View>\n              </ImageBackground>\n            ) : (\n              <Camera style={styles.camera} type={type} ref={setCameraRef}>\n                <View style={styles.photoView}>\n                  <TouchableOpacity\n                    style={styles.flipContainer}\n                    onPress={() => {\n                      setType(\n                        type === Camera.Constants.Type.back\n                          ? Camera.Constants.Type.front\n                          : Camera.Constants.Type.back\n                      );\n                    }}\n                  >\n                    <Feather name=\"repeat\" size={20} color=\"#BDBDBD\" />\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    style={styles.cameraButton}\n                    onPress={handleCameraPress}\n                  >\n                    <Ionicons name=\"camera\" size={30} color=\"#BDBDBD\" />\n                  </TouchableOpacity>\n                </View>\n              </Camera>\n            )}\n          </View>\n\n          {/* {selectedPhoto !== null ? (\n            <Text style={styles.text}>Редагувати фото</Text>\n          ) : (\n            <Text style={styles.text}>Завантажте фото</Text>\n          )} */}\n\n          {state.photoUri !== \"\" ? (\n            <TouchableOpacity\n              onPress={() => setState((prev) => ({ ...prev, photoUri: \"\" }))}\n            >\n              <Text style={styles.text}>Редагувати фото</Text>\n            </TouchableOpacity>\n          ) : (\n            <TouchableOpacity onPress={pickImage}>\n              <Text style={styles.text}>Завантажити фото</Text>\n            </TouchableOpacity>\n          )}\n\n          <View style={{ marginTop: -keyboardHeight }}>\n            <KeyboardAvoidingView\n              behavior={Platform.OS == \"ios\" ? \"padding\" : \"height\"}\n            >\n              <Input\n                placeholder=\"Назва...\"\n                value={state.titlePost}\n                onChangeText={(value) => {\n                  setState((prev) => ({ ...prev, titlePost: value }));\n                  setIsDirtyForm(value.length > 0 ? true : false);\n                }}\n              />\n              <Ionicons\n                style={{\n                  position: \"absolute\",\n                  top: 10,\n                  left: 10,\n                }}\n                name=\"attach\"\n                size={25}\n                color=\"#BDBDBD\"\n              />\n              <Input\n                placeholder=\"Місцевість...\"\n                value={state.location?.title}\n                onChangeText={(value) => {\n                  setState((prev) => ({\n                    ...prev,\n                    location: { ...prev.location, title: value },\n                  }));\n                  setIsDirtyForm(value.length > 0 ? true : false);\n                }}\n              />\n              <Ionicons\n                style={{\n                  position: \"absolute\",\n                  top: 80,\n                  left: 10,\n                }}\n                name=\"navigate\"\n                size={20}\n                color=\"#BDBDBD\"\n              />\n            </KeyboardAvoidingView>\n          </View>\n          {state.photoUri !== \"\" &&\n          state.location !== \"\" &&\n          state.titlePost !== \"\" ? (\n            <CustomButton text=\"Опублікувати\" onPress={uploadPostToServer} />\n          ) : (\n            <UnactiveButton text=\"Опублікувати\" />\n          )}\n\n          <View style={styles.delete}>\n            <UnactiveButton width={70} onPress={() => setState(INITIAL_POST)} />\n            <Ionicons\n              style={{\n                position: \"absolute\",\n                top: 25,\n                left: 22,\n              }}\n              name=\"trash\"\n              size={25}\n              color=\"#BDBDBD\"\n              onPress={setState(INITIAL_POST)}\n            />\n          </View>\n        </View>\n      </View>\n    </TouchableWithoutFeedback>\n  );\n}\n\nconst styles = StyleSheet.create({\n  main: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    borderColor: \"grey\",\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n  },\n  parent: {\n    marginHorizontal: 20,\n    marginVertical: 40,\n  },\n  container: {\n    flex: 1,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  camera: {\n    // width: 350,\n    width: \"100%\",\n    height: 240,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#f6f6f6\",\n    borderColor: \"#E8E8E8\",\n    borderWidth: 1,\n    borderRadius: 8,\n    overflow: \"hidden\",\n  },\n  cameraButton: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"#fff\",\n    borderRadius: \"50%\",\n  },\n  photoView: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    justifyContent: \"center\",\n  },\n  cameraButtonSelected: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: 60,\n    height: 60,\n    backgroundColor: \"rgba(255, 255, 255, 0.3);\",\n    borderRadius: \"50%\",\n  },\n  photoViewSelected: {\n    flex: 1,\n    backgroundColor: \"transparent\",\n    marginTop: 90,\n  },\n  flipContainer: {\n    position: \"absolute\",\n    top: 10,\n    right: -120,\n  },\n  text: {\n    color: \"#BDBDBD\",\n    marginLeft: 10,\n    marginTop: 10,\n    marginBottom: 20,\n  },\n  placeholderContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  placeholderText: {\n    marginLeft: 5,\n    color: \"#BDBDBD\",\n  },\n  delete: {\n    position: \"absolute\",\n    top: \"130%\",\n    right: \"25%\",\n    transform: [{ translateX: -50 }, { translateY: -50 }],\n    // bottom: -180,\n    // left: 130,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}